<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Setting the working directory | Spatial Analysis Notes</title>
  <meta name="description" content="Materials for a Spatial Analysis course in R." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Setting the working directory | Spatial Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Materials for a Spatial Analysis course in R." />
  <meta name="github-repo" content="gdsl-ul/san" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Setting the working directory | Spatial Analysis Notes" />
  
  <meta name="twitter:description" content="Materials for a Spatial Analysis course in R." />
  

<meta name="author" content="Francisco Rowe &amp; Dani Arribas-Bel" />


<meta name="date" content="2020-02-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="basic-mapping.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Spatial Analysis Notes</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#dependencies"><i class="fa fa-check"></i><b>2.1</b> Dependencies</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#introducing-r"><i class="fa fa-check"></i><b>2.2</b> Introducing R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html"><i class="fa fa-check"></i><b>3</b> Setting the working directory</a><ul>
<li class="chapter" data-level="3.1" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#r-scripts-and-notebooks"><i class="fa fa-check"></i><b>3.1</b> R Scripts and Notebooks</a></li>
<li class="chapter" data-level="3.2" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#getting-help"><i class="fa fa-check"></i><b>3.2</b> Getting Help</a></li>
<li class="chapter" data-level="3.3" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#variables-and-objects"><i class="fa fa-check"></i><b>3.3</b> Variables and objects</a></li>
<li class="chapter" data-level="3.4" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#basic-data-types"><i class="fa fa-check"></i><b>3.4</b> Basic Data Types</a></li>
<li class="chapter" data-level="3.5" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#random-variables"><i class="fa fa-check"></i><b>3.5</b> Random Variables</a><ul>
<li class="chapter" data-level="3.5.1" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#factor"><i class="fa fa-check"></i><b>3.5.1</b> Factor</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#create-a-factor"><i class="fa fa-check"></i><b>3.6</b> Create a factor</a></li>
<li class="chapter" data-level="3.7" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#data-frames"><i class="fa fa-check"></i><b>3.7</b> Data Frames</a><ul>
<li class="chapter" data-level="3.7.1" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#create-a-data-frame"><i class="fa fa-check"></i><b>3.7.1</b> Create a data frame</a></li>
<li class="chapter" data-level="3.7.2" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#referencing-data-frame"><i class="fa fa-check"></i><b>3.7.2</b> Referencing data frame</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#read-data"><i class="fa fa-check"></i><b>3.8</b> Read Data</a><ul>
<li class="chapter" data-level="3.8.1" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#quickly-inspect-the-data"><i class="fa fa-check"></i><b>3.8.1</b> Quickly inspect the data</a></li>
<li class="chapter" data-level="3.8.2" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#adding-new-variables"><i class="fa fa-check"></i><b>3.8.2</b> Adding new variables</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#selecting-variables"><i class="fa fa-check"></i><b>3.9</b> Selecting variables</a></li>
<li class="chapter" data-level="3.10" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#filtering-data"><i class="fa fa-check"></i><b>3.10</b> Filtering data</a><ul>
<li class="chapter" data-level="3.10.1" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#joining-data-frames"><i class="fa fa-check"></i><b>3.10.1</b> Joining data frames</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#saving"><i class="fa fa-check"></i><b>3.11</b> Saving</a></li>
<li class="chapter" data-level="3.12" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#spatial-data-frames"><i class="fa fa-check"></i><b>3.12</b> Spatial Data Frames</a></li>
<li class="chapter" data-level="3.13" data-path="setting-the-working-directory.html"><a href="setting-the-working-directory.html#read-spatial-data"><i class="fa fa-check"></i><b>3.13</b> Read Spatial Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="basic-mapping.html"><a href="basic-mapping.html"><i class="fa fa-check"></i><b>4</b> Basic Mapping</a><ul>
<li class="chapter" data-level="4.0.1" data-path="basic-mapping.html"><a href="basic-mapping.html#using-plot"><i class="fa fa-check"></i><b>4.0.1</b> Using <code>plot</code></a></li>
<li class="chapter" data-level="4.0.2" data-path="basic-mapping.html"><a href="basic-mapping.html#using-tmap"><i class="fa fa-check"></i><b>4.0.2</b> Using <code>tmap</code></a></li>
<li class="chapter" data-level="4.0.3" data-path="basic-mapping.html"><a href="basic-mapping.html#comparing-geographies"><i class="fa fa-check"></i><b>4.0.3</b> Comparing geographies</a></li>
<li class="chapter" data-level="4.1" data-path="basic-mapping.html"><a href="basic-mapping.html#useful-functions"><i class="fa fa-check"></i><b>4.1</b> Useful Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="points.html"><a href="points.html"><i class="fa fa-check"></i><b>5</b> Points</a><ul>
<li class="chapter" data-level="5.1" data-path="points.html"><a href="points.html#dependencies-1"><i class="fa fa-check"></i><b>5.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.2" data-path="points.html"><a href="points.html#data"><i class="fa fa-check"></i><b>5.2</b> Data</a></li>
<li class="chapter" data-level="5.3" data-path="points.html"><a href="points.html#kde"><i class="fa fa-check"></i><b>5.3</b> KDE</a><ul>
<li class="chapter" data-level="5.3.1" data-path="points.html"><a href="points.html#one-dimensional-kde"><i class="fa fa-check"></i><b>5.3.1</b> One-dimensional KDE</a></li>
<li class="chapter" data-level="5.3.2" data-path="points.html"><a href="points.html#two-dimensional-spatial-kde"><i class="fa fa-check"></i><b>5.3.2</b> Two-dimensional (spatial) KDE</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="points.html"><a href="points.html#spatial-interpolation"><i class="fa fa-check"></i><b>5.4</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="5.4.1" data-path="points.html"><a href="points.html#inverse-distance-weight-idw-interpolation"><i class="fa fa-check"></i><b>5.4.1</b> Inverse Distance Weight (IDW) interpolation</a></li>
<li class="chapter" data-level="5.4.2" data-path="points.html"><a href="points.html#a-surface-of-housing-prices"><i class="fa fa-check"></i><b>5.4.2</b> A surface of housing prices</a></li>
<li class="chapter" data-level="5.4.3" data-path="points.html"><a href="points.html#what-should-the-next-houses-price-be"><i class="fa fa-check"></i><b>5.4.3</b> <em>“What should the next house’s price be?”</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="flows.html"><a href="flows.html"><i class="fa fa-check"></i><b>6</b> Flows</a></li>
<li class="chapter" data-level="7" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html"><i class="fa fa-check"></i><b>7</b> Spatial Econometrics</a></li>
<li class="chapter" data-level="8" data-path="multilevel-models-pt-i.html"><a href="multilevel-models-pt-i.html"><i class="fa fa-check"></i><b>8</b> Multilevel Models (Pt. I)</a></li>
<li class="chapter" data-level="9" data-path="multilevel-models-pt-ii.html"><a href="multilevel-models-pt-ii.html"><i class="fa fa-check"></i><b>9</b> Multilevel Models (Pt. II)</a></li>
<li class="chapter" data-level="10" data-path="gwr.html"><a href="gwr.html"><i class="fa fa-check"></i><b>10</b> GWR</a></li>
<li class="chapter" data-level="11" data-path="space-time-analysis.html"><a href="space-time-analysis.html"><i class="fa fa-check"></i><b>11</b> Space-Time Analysis</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="setting-the-working-directory" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Setting the working directory</h1>
<p>Before we start any analysis, ensure to set the path to the directory where we are working. We can easily do that with <code>setwd()</code>. Please replace in the following line the path to the folder where you have placed this file -and where the <code>data</code> folder lives.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#setwd(&#39;../data/sar.csv&#39;)</span>
<span class="co">#setwd(&#39;.&#39;)</span></code></pre></div>
<p>Note: It is good practice to not include spaces when naming folders and files. Use <em>underscores</em> or <em>dots</em>.</p>
<p>You can check your current working directory by typing:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getwd</span>()</code></pre></div>
<pre><code>## [1] &quot;/Users/Franciscorowe/Dropbox/Francisco/uol/teaching/envs453/201920/lectures/san&quot;</code></pre>
<div id="r-scripts-and-notebooks" class="section level2">
<h2><span class="header-section-number">3.1</span> R Scripts and Notebooks</h2>
<p>An <em>R script</em> is a series of commands that you can execute at one time and help you save time. So you don’t repeat the same steps every time you want to execute the same process with different datasets. An R script is just a plain text file with R commands in it.</p>
<p>To create an R script in RStudio, you need to</p>
<ul>
<li><p>Open a new script file: <em>File</em> &gt; <em>New File</em> &gt; <em>R Script</em></p></li>
<li><p>Write some code on your new script window by typing eg. <code>mtcars</code></p></li>
<li><p>Run the script. Click anywhere on the line of code, then hit <em>Ctrl + Enter</em> (Windows) or <em>Cmd + Enter</em> (Mac) to run the command or select the code chunk and click <em>run</em> on the right-top corner of your script window. If do that, you should get:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars</code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<ul>
<li>Save the script: <em>File</em> &gt; <em>Save As</em>, select your required destination folder, and enter any filename that you like, provided that it ends with the file extension <em>.R</em></li>
</ul>
<p>An <em>R Notebook</em> is an R Markdown document with descriptive text and code chunks that can be executed independently and interactively, with output visible immediately beneath a code chunk - see <span class="citation">Xie, Allaire, and Grolemund (<a href="#ref-Xie_et_al_2019_book">2019</a>)</span>.</p>
<p>To create an R Notebook, you need to:</p>
<ul>
<li>Open a new script file: <em>File</em> &gt; <em>New File</em> &gt; <em>R Notebook</em></li>
</ul>
<div class="figure">
<img src="../san/figs/rnotebook_yaml.png" alt="Fig. 2. YAML metadata for notebooks." />
<p class="caption">Fig. 2. YAML metadata for notebooks.</p>
</div>
<ul>
<li>Insert code chunks, either:</li>
</ul>
<ol style="list-style-type: decimal">
<li>use the <em>Insert</em> command on the editor toolbar;</li>
<li>use the keyboard shortcut <em>Ctrl + Alt + I</em> or <em>Cmd + Option + I</em> (Mac); or,</li>
<li>type the chunk delimiters <code>```{r}</code> and <code>```</code></li>
</ol>
<p>In a chunk code you can produce text output, tables, graphics and write code! You can control these outputs via chunk options which are provided inside the curly brackets eg.</p>
<div class="figure">
<img src="../san/figs/codechunk.png" alt="Fig. 3. Code chunk example. Details on the various options: https://rmarkdown.rstudio.com/lesson-3.html" />
<p class="caption">Fig. 3. Code chunk example. Details on the various options: <a href="https://rmarkdown.rstudio.com/lesson-3.html" class="uri">https://rmarkdown.rstudio.com/lesson-3.html</a></p>
</div>
<ul>
<li><p>Execute code: hit <em>“Run Current Chunk”</em>, <em>Ctrl + Shift + Enter</em> or <em>Cmd + Shift + Enter</em> (Mac)</p></li>
<li><p>Save an R notebook: <em>File</em> &gt; <em>Save As</em>. A notebook has a <code>*.Rmd</code> extension and when it is saved a <code>*.nb.html</code> file is automatically created. The latter is a self-contained HTML file which contains both a rendered copy of the notebook with all current chunk outputs and a copy of the *.Rmd file itself.</p></li>
</ul>
<p>Rstudio also offers a <em>Preview</em> option on the toolbar which can be used to create pdf, html and word versions of the notebook. To do this, choose from the drop-down list menu <code>knit to ...</code></p>
</div>
<div id="getting-help" class="section level2">
<h2><span class="header-section-number">3.2</span> Getting Help</h2>
<p>You can use <code>help</code> or <code>?</code> to ask for details for a specific function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(sqrt) <span class="co">#or ?sqrt</span></code></pre></div>
<p>And using <code>example</code> provides examples for said function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">example</span>(sqrt)</code></pre></div>
<pre><code>## 
## sqrt&gt; require(stats) # for spline
## 
## sqrt&gt; require(graphics)
## 
## sqrt&gt; xx &lt;- -9:9
## 
## sqrt&gt; plot(xx, sqrt(abs(xx)),  col = &quot;red&quot;)</code></pre>
<div class="figure"><span id="fig:unnamed-chunk-7"></span>
<img src="01-intro_files/figure-html/unnamed-chunk-7-1.png" alt="Example sqrt" width="672" />
<p class="caption">
Figure 3.1: Example sqrt
</p>
</div>
<pre><code>## 
## sqrt&gt; lines(spline(xx, sqrt(abs(xx)), n=101), col = &quot;pink&quot;)</code></pre>
</div>
<div id="variables-and-objects" class="section level2">
<h2><span class="header-section-number">3.3</span> Variables and objects</h2>
<p>An <em>object</em> is a data structure having attributes and methods. In fact, everything in R is an object!</p>
<p>A <em>variable</em> is a type of data object. Data objects also include list, vector, matrices and text.</p>
<ul>
<li>Creating a data object</li>
</ul>
<p>In R a variable can be created by using the symbol <code>&lt;-</code> to assign a value to a variable name. The variable name is entered on the left <code>&lt;-</code> and the value on the right. Note: Data objects can be given any name, provided that they start with a letter of the alphabet, and include only letters of the alphabet, numbers and the characters <code>.</code> and <code>_</code>. Hence AgeGroup, Age_Group and Age.Group are all valid names for an R data object. Note also that R is case-sensitive, to agegroup and AgeGroup would be treated as different data objects.</p>
<p>To save the value <em>28</em> to a variable (data object) labelled <em>age</em>, run the code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age &lt;-<span class="st"> </span><span class="dv">28</span></code></pre></div>
<ul>
<li>Inspecting a data object</li>
</ul>
<p>To inspect the contents of the data object <em>age</em> run the following line of code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age</code></pre></div>
<pre><code>## [1] 28</code></pre>
<p>Find out what kind (class) of data object <em>age</em> is using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(age) </code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<p>Inspect the structure of the <em>age</em> data object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(age) </code></pre></div>
<pre><code>##  num 28</code></pre>
<ul>
<li>The <em>vector</em> data object</li>
</ul>
<p>What if we have more than one response? We can use the <code>c( )</code> function to combine multiple values into one data vector object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">28</span>, <span class="dv">36</span>, <span class="dv">25</span>, <span class="dv">24</span>, <span class="dv">32</span>)
age</code></pre></div>
<pre><code>## [1] 28 36 25 24 32</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(age) <span class="co">#Still numeric..</span></code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(age) <span class="co">#..but now a vector (set) of 5 separate values</span></code></pre></div>
<pre><code>##  num [1:5] 28 36 25 24 32</code></pre>
<p>Note that on each line in the code above any text following the <code>#</code> character is ignored by R when executing the code. Instead, text following a <code>#</code> can be used to add comments to the code to make clear what the code is doing. Two marks of good code are a clear layout and clear commentary on the code.</p>
</div>
<div id="basic-data-types" class="section level2">
<h2><span class="header-section-number">3.4</span> Basic Data Types</h2>
<p>There are a number of data types. Four are the most common. In R, <strong>numeric</strong> is the default type for numbers. It stores all numbers as floating-point numbers (numbers with decimals). This is because most statistical calculations deal with numbers with up to two decimals.</p>
<ul>
<li>Numeric</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num &lt;-<span class="st"> </span><span class="fl">4.5</span> <span class="co"># Decimal values</span>
<span class="kw">class</span>(num)</code></pre></div>
<pre><code>## [1] &quot;numeric&quot;</code></pre>
<ul>
<li>Integer</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">int &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="dv">4</span>) <span class="co"># Natural numbers. Note integers are also numerics.</span>
<span class="kw">class</span>(int)</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<ul>
<li>Character</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cha &lt;-<span class="st"> &quot;are you enjoying this?&quot;</span> <span class="co"># text or string. You can also type `as.character(&quot;are you enjoying this?&quot;)`</span>
<span class="kw">class</span>(cha)</code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<ul>
<li>Logical</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">log &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span> <span class="co"># assigns TRUE or FALSE. In this case, FALSE as 2 is greater than 1</span>
log</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(log)</code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
</div>
<div id="random-variables" class="section level2">
<h2><span class="header-section-number">3.5</span> Random Variables</h2>
<p>In statistics, we differentiate between data to capture:</p>
<ul>
<li><p><em>Qualitative attributes</em> categorise objects eg.gender, marital status. To measure these attributes, we use <em>Categorical</em> data which can be divided into:</p></li>
<li><em>Nominal</em> data in categories that have no inherent order eg. gender</li>
<li><p><em>Ordinal</em> data in categories that have an inherent order eg. income bands</p></li>
<li><p><em>Quantitative attributes</em>:</p></li>
<li><em>Discrete</em> data: count objects of a certain category eg. number of kids, cars</li>
<li><p><em>Continuous</em> data: precise numeric measures eg. weight, income, length.</p></li>
</ul>
<p>In R these three types of random variables are represented by the following types of R data object:</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
variables
</th>
<th style="text-align:left;">
objects
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
nominal
</td>
<td style="text-align:left;">
factor
</td>
</tr>
<tr>
<td style="text-align:left;">
ordinal
</td>
<td style="text-align:left;">
ordered factor
</td>
</tr>
<tr>
<td style="text-align:left;">
discrete
</td>
<td style="text-align:left;">
numeric
</td>
</tr>
<tr>
<td style="text-align:left;">
continuous
</td>
<td style="text-align:left;">
numeric
</td>
</tr>
</tbody>
</table>
<p>We have already encountered the R data type <em>numeric</em>. The next section introduces the <em>factor</em> data type.</p>
<div id="factor" class="section level3">
<h3><span class="header-section-number">3.5.1</span> Factor</h3>
<div id="what-is-a-factor" class="section level4">
<h4><span class="header-section-number">3.5.1.1</span> What is a factor?</h4>
<p>A factor variable assigns a numeric code to each possible category (<em>level</em>) in a variable. Behind the scenes, R stores the variable using these numeric codes to save space and speed up computing. For example, compare the size of a list of <code>10,000</code> <em>males</em> and <em>females</em> to a list of <code>10,000</code> <code>1s</code> and <code>0s</code>. At the same time R also saves the category names associated with each numeric code (level). These are used for display purposes.</p>
<p>For example, the variable <em>gender</em>, converted to a factor, would be stored as a series of <code>1s</code> and <code>2s</code>, where <code>1 = female</code> and <code>2 = male</code>; but would be displayed in all outputs using their category labels of <em>female</em> and <em>male</em>.</p>
</div>
</div>
</div>
<div id="create-a-factor" class="section level2">
<h2><span class="header-section-number">3.6</span> Create a factor</h2>
<p>To convert a numeric or character vector into a factor use the <code>factor( )</code> function. For instance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gender &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;female&quot;</span>,<span class="st">&quot;male&quot;</span>,<span class="st">&quot;male&quot;</span>,<span class="st">&quot;female&quot;</span>,<span class="st">&quot;female&quot;</span>) <span class="co"># create a gender variable</span>
gender &lt;-<span class="st"> </span><span class="kw">factor</span>(gender) <span class="co"># replace character vector with a factor version</span>
gender</code></pre></div>
<pre><code>## [1] female male   male   female female
## Levels: female male</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(gender)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(gender)</code></pre></div>
<pre><code>##  Factor w/ 2 levels &quot;female&quot;,&quot;male&quot;: 1 2 2 1 1</code></pre>
<p>Now <em>gender</em> is a factor and is stored as a series of <code>1s</code> and <code>2s</code>, with <code>1s</code> representing <code>females</code> and <code>2s</code> representing <code>males</code>. The function <code>levels( )</code> lists the levels (categories) associated with a given factor variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(gender)</code></pre></div>
<pre><code>## [1] &quot;female&quot; &quot;male&quot;</code></pre>
<p>The categories are reported in the order that they have been numbered (starting from <code>1</code>). Hence from the output we can infer that <code>females</code> are coded as <code>1</code>, and <code>males</code> as <code>2</code>.</p>
</div>
<div id="data-frames" class="section level2">
<h2><span class="header-section-number">3.7</span> Data Frames</h2>
<p>R stores different types of data using different types of data structure. Data are normally stored as a <em>data.frame</em>. A data frames contain one row per observation (e.g. wards) and one column per attribute (eg. population and health).</p>
<p>We create three variables wards, population (<code>pop</code>) and people with good health (<code>ghealth</code>). We use 2011 census data counts for total population and good health for wards in Liverpool.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wards &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Allerton and Hunts Cross&quot;</span>,<span class="st">&quot;Anfield&quot;</span>,<span class="st">&quot;Belle Vale&quot;</span>,<span class="st">&quot;Central&quot;</span>,<span class="st">&quot;Childwall&quot;</span>,<span class="st">&quot;Church&quot;</span>,<span class="st">&quot;Clubmoor&quot;</span>,<span class="st">&quot;County&quot;</span>,<span class="st">&quot;Cressington&quot;</span>,<span class="st">&quot;Croxteth&quot;</span>,<span class="st">&quot;Everton&quot;</span>,<span class="st">&quot;Fazakerley&quot;</span>,<span class="st">&quot;Greenbank&quot;</span>,<span class="st">&quot;Kensington and Fairfield&quot;</span>,<span class="st">&quot;Kirkdale&quot;</span>,<span class="st">&quot;Knotty Ash&quot;</span>,<span class="st">&quot;Mossley Hill&quot;</span>,<span class="st">&quot;Norris Green&quot;</span>,<span class="st">&quot;Old Swan&quot;</span>,<span class="st">&quot;Picton&quot;</span>,<span class="st">&quot;Princes Park&quot;</span>,<span class="st">&quot;Riverside&quot;</span>,<span class="st">&quot;St Michael&#39;s&quot;</span>,<span class="st">&quot;Speke-Garston&quot;</span>,<span class="st">&quot;Tuebrook and Stoneycroft&quot;</span>,<span class="st">&quot;Warbreck&quot;</span>,<span class="st">&quot;Wavertree&quot;</span>,<span class="st">&quot;West Derby&quot;</span>,<span class="st">&quot;Woolton&quot;</span>,<span class="st">&quot;Yew Tree&quot;</span>)

pop &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">14853</span>,<span class="dv">14510</span>,<span class="dv">15004</span>,<span class="dv">20340</span>,<span class="dv">13908</span>,<span class="dv">13974</span>,<span class="dv">15272</span>,<span class="dv">14045</span>,<span class="dv">14503</span>,
                <span class="dv">14561</span>,<span class="dv">14782</span>,<span class="dv">16786</span>,<span class="dv">16132</span>,<span class="dv">15377</span>,<span class="dv">16115</span>,<span class="dv">13312</span>,<span class="dv">13816</span>,<span class="dv">15047</span>,
                <span class="dv">16461</span>,<span class="dv">17009</span>,<span class="dv">17104</span>,<span class="dv">18422</span>,<span class="dv">12991</span>,<span class="dv">20300</span>,<span class="dv">16489</span>,<span class="dv">16481</span>,<span class="dv">14772</span>,
                <span class="dv">14382</span>,<span class="dv">12921</span>,<span class="dv">16746</span>)

ghealth &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">7274</span>,<span class="dv">6124</span>,<span class="dv">6129</span>,<span class="dv">11925</span>,<span class="dv">7219</span>,<span class="dv">7461</span>,<span class="dv">6403</span>,<span class="dv">5930</span>,<span class="dv">7094</span>,<span class="dv">6992</span>,
                 <span class="dv">5517</span>,<span class="dv">7879</span>,<span class="dv">8990</span>,<span class="dv">6495</span>,<span class="dv">6662</span>,<span class="dv">5981</span>,<span class="dv">7322</span>,<span class="dv">6529</span>,<span class="dv">7192</span>,<span class="dv">7953</span>,
                 <span class="dv">7636</span>,<span class="dv">9001</span>,<span class="dv">6450</span>,<span class="dv">8973</span>,<span class="dv">7302</span>,<span class="dv">7521</span>,<span class="dv">7268</span>,<span class="dv">7013</span>,<span class="dv">6025</span>,<span class="dv">7717</span>)</code></pre></div>
<p>Note that <code>pop</code> and <code>ghealth</code> and <code>wards</code> contains characters.</p>
<div id="create-a-data-frame" class="section level3">
<h3><span class="header-section-number">3.7.1</span> Create a data frame</h3>
<p>We can create a data frame and examine its structure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(wards, pop, ghealth)
df <span class="co"># or use view(data)</span></code></pre></div>
<pre><code>##                       wards   pop ghealth
## 1  Allerton and Hunts Cross 14853    7274
## 2                   Anfield 14510    6124
## 3                Belle Vale 15004    6129
## 4                   Central 20340   11925
## 5                 Childwall 13908    7219
## 6                    Church 13974    7461
## 7                  Clubmoor 15272    6403
## 8                    County 14045    5930
## 9               Cressington 14503    7094
## 10                 Croxteth 14561    6992
## 11                  Everton 14782    5517
## 12               Fazakerley 16786    7879
## 13                Greenbank 16132    8990
## 14 Kensington and Fairfield 15377    6495
## 15                 Kirkdale 16115    6662
## 16               Knotty Ash 13312    5981
## 17             Mossley Hill 13816    7322
## 18             Norris Green 15047    6529
## 19                 Old Swan 16461    7192
## 20                   Picton 17009    7953
## 21             Princes Park 17104    7636
## 22                Riverside 18422    9001
## 23             St Michael&#39;s 12991    6450
## 24            Speke-Garston 20300    8973
## 25 Tuebrook and Stoneycroft 16489    7302
## 26                 Warbreck 16481    7521
## 27                Wavertree 14772    7268
## 28               West Derby 14382    7013
## 29                  Woolton 12921    6025
## 30                 Yew Tree 16746    7717</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(df) <span class="co"># or use glimpse(data) </span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    30 obs. of  3 variables:
##  $ wards  : Factor w/ 30 levels &quot;Allerton and Hunts Cross&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ pop    : num  14853 14510 15004 20340 13908 ...
##  $ ghealth: num  7274 6124 6129 11925 7219 ...</code></pre>
</div>
<div id="referencing-data-frame" class="section level3">
<h3><span class="header-section-number">3.7.2</span> Referencing data frame</h3>
<p>Throughout this module, you will need to refer to particular parts of a dataframe - perhaps a particular column (an area attribute); or a particular subset of respondents. Hence it is worth spending some time now mastering this particular skill.</p>
<p>The relevant R function, <code>[ ]</code>, has the format <code>[row,col]</code> or, more generally, <code>[set of rows, set of cols]</code>.</p>
<p>Run the following commands to get a feel of how to extract different slices of the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df <span class="co"># whole data.frame</span>
df[<span class="dv">1</span>, <span class="dv">1</span>] <span class="co"># contents of first row and column</span>
df[<span class="dv">2</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>] <span class="co"># contents of the second row, second and third columns</span>
df[<span class="dv">1</span>, ] <span class="co"># first row, ALL columns [the default if no columns specified]</span>
df[ ,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] <span class="co"># ALL rows; first and second columns</span>
df[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>), ] <span class="co"># rows 1,3,5; ALL columns</span>
df[ , <span class="dv">2</span>] <span class="co"># ALL rows; second column (by default results containing only </span>
             <span class="co">#one column are converted back into a vector)</span>
df[ , <span class="dv">2</span>, drop=<span class="ot">FALSE</span>] <span class="co"># ALL rows; second column (returned as a data.frame)</span></code></pre></div>
<p>In the above, note that we have used two other R functions:</p>
<ul>
<li><p><code>1:3</code> The colon operator tells R to produce a list of numbers including the named start and end points.</p></li>
<li><p><code>c(1,3,5)</code> Tells R to combine the contents within the brackets into one list of objects</p></li>
</ul>
<p>Run both of these fuctions on their own to get a better understanding of what they do.</p>
<p>Three other methods for referencing the contents of a data.frame make direct use of the variable names within the data.frame, which tends to make for easier to read/understand code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df[,<span class="st">&quot;pop&quot;</span>] <span class="co"># variable name in quotes inside the square brackets</span>
df<span class="op">$</span>pop <span class="co"># variable name prefixed with $ and appended to the data.frame name</span>
<span class="co"># or you can use attach</span>
<span class="kw">attach</span>(df)
pop <span class="co"># but be careful if you already have an age variable in your local workspace</span></code></pre></div>
<p>Want to check the variables available, use the <code>names( )</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(df)</code></pre></div>
<pre><code>## [1] &quot;wards&quot;   &quot;pop&quot;     &quot;ghealth&quot;</code></pre>
</div>
</div>
<div id="read-data" class="section level2">
<h2><span class="header-section-number">3.8</span> Read Data</h2>
<p>Ensure your memory is clear</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) <span class="co"># rm for targeted deletion / ls for listing all existing objects</span></code></pre></div>
<p>There are many commands to read / load data onto R. The command to use will depend upon the format they have been saved. Normally they are saved in <em>csv</em> format from Excel or other software packages. So we use either:</p>
<ul>
<li><code>df &lt;- read.table(&quot;path/file_name.csv&quot;, header = FALSE, sep =&quot;,&quot;)</code></li>
<li><code>df &lt;- read(&quot;path/file_name.csv&quot;, header = FALSE)</code></li>
<li><code>df &lt;- read.csv2(&quot;path/file_name.csv&quot;, header = FALSE)</code></li>
</ul>
<p>To read files in other formats, refer to this useful <a href="https://www.datacamp.com/community/tutorials/r-data-import-tutorial?utm_source=adwords_ppc&amp;utm_campaignid=1655852085&amp;utm_adgroupid=61045434382&amp;utm_device=c&amp;utm_keyword=%2Bread%20%2Bdata%20%2Br&amp;utm_matchtype=b&amp;utm_network=g&amp;utm_adpostion=1t1&amp;utm_creative=318880582308&amp;utm_targetid=kwd-309793905111&amp;utm_loc_interest_ms=&amp;utm_loc_physical_ms=9046551&amp;gclid=CjwKCAiA3uDwBRBFEiwA1VsajJO0QK0Jg7VipIt8_t82qQrnUliI0syAlh8CIxnE76Rb0kh3FbiehxoCzCgQAvD_BwE#csv">DataCamp tutorial</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">census &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../san/data/census/census_data.csv&quot;</span>)
<span class="kw">head</span>(census)</code></pre></div>
<pre><code>##        code                     ward pop16_74 higher_managerial   pop
## 1 E05000886 Allerton and Hunts Cross    10930              1103 14853
## 2 E05000887                  Anfield    10712               312 14510
## 3 E05000888               Belle Vale    10987               432 15004
## 4 E05000889                  Central    19174              1346 20340
## 5 E05000890                Childwall    10410              1123 13908
## 6 E05000891                   Church    10569              1843 13974
##   ghealth
## 1    7274
## 2    6124
## 3    6129
## 4   11925
## 5    7219
## 6    7461</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># </span><span class="al">NOTE</span><span class="co">: always ensure your are setting the correct directory leading to the data. </span>
<span class="co"># It may differ from your existing working directory</span></code></pre></div>
<div id="quickly-inspect-the-data" class="section level3">
<h3><span class="header-section-number">3.8.1</span> Quickly inspect the data</h3>
<ol style="list-style-type: decimal">
<li><p>What class?</p></li>
<li><p>What R data types?</p></li>
<li><p>What data types?</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 1</span>
<span class="kw">class</span>(census)
<span class="co"># 2 &amp; 3</span>
<span class="kw">str</span>(census)</code></pre></div>
<p>Just interested in the variable names:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(census)</code></pre></div>
<pre><code>## [1] &quot;code&quot;              &quot;ward&quot;              &quot;pop16_74&quot;         
## [4] &quot;higher_managerial&quot; &quot;pop&quot;               &quot;ghealth&quot;</code></pre>
<p>or want to view the data:</p>
<p><code>View(census)</code></p>
</div>
<div id="adding-new-variables" class="section level3">
<h3><span class="header-section-number">3.8.2</span> Adding new variables</h3>
<p>Usually you want to add / create new variables to your data frame using existing variables eg. computing percentages by dividing two variables. There are many ways in which you can do this i.e. referecing a data frame as we have done above, or using <code>$</code> (e.g. <code>census$pop</code>). For this module, we’ll use <code>tidyverse</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">census &lt;-<span class="st"> </span>census <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">per_ghealth =</span> ghealth <span class="op">/</span><span class="st"> </span>pop)</code></pre></div>
<p>Note we used a <em>pipe operator</em> <code>%&gt;%</code>, which helps make the code more efficient and readable - more details, see <span class="citation">Grolemund and Wickham (<a href="#ref-grolemund_wickham_2019_book">2019</a>)</span>. When using the pipe operator, recall to first indicate the data frame before <code>%&gt;%</code>.</p>
<p>Note also the use a variable name before the <code>=</code> sign in brackets to indicate the name of the new variable after <code>mutate</code>.</p>
</div>
</div>
<div id="selecting-variables" class="section level2">
<h2><span class="header-section-number">3.9</span> Selecting variables</h2>
<p>Usually you want to select a subset of variables for your analysis as storing to large data sets in your R memory can reduce the processing speed of your machine. A selection of data can be achieved by using the <code>select</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ndf &lt;-<span class="st"> </span>census <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(ward, pop16_<span class="dv">74</span>, per_ghealth)</code></pre></div>
<p>Again first indicate the data frame and then the variable you want to select to build a new data frame. Note the code chunk above has created a new data frame called <code>ndf</code>. Explore it.</p>
</div>
<div id="filtering-data" class="section level2">
<h2><span class="header-section-number">3.10</span> Filtering data</h2>
<p>You may also want to filter values based on defined conditions. You may want to filter observations greater than a certain threshold or only areas within a certain region. For example, you may want to select areas with a percentage of good health population over 50%:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ndf2 &lt;-<span class="st"> </span>census <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(per_ghealth <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.5</span>)</code></pre></div>
<p>You can use more than one variables to set conditions. Use “<code>,</code>” to add a condition.</p>
<div id="joining-data-frames" class="section level3">
<h3><span class="header-section-number">3.10.1</span> Joining data frames</h3>
<p>When working with spatial data, we often need to join data. To this end, you need a common unique <code>id variable</code>. Let’s say, we want to add a data frame containing census data on households for Liverpool, and join the new attributes to one of the existing data frames in the workspace. First we will read the data frame we want to join (ie. <code>census_data2.csv</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read data</span>
census2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;../san/data/census/census_data2.csv&quot;</span>)
<span class="co"># visualise data structure</span>
<span class="kw">str</span>(census2)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    30 obs. of  3 variables:
##  $ geo_code               : Factor w/ 30 levels &quot;E05000886&quot;,&quot;E05000887&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ households             : int  6359 6622 6622 7139 5391 5884 6576 6745 6317 6024 ...
##  $ socialrented_households: int  827 1508 2818 1311 374 178 2859 1564 1023 1558 ...</code></pre>
<p>The variable <code>geo_code</code> in this data frame corresponds to the <code>code</code> in the existing data frame and they are unique so they can be automatically matched by using the <code>merge()</code> function. The <code>merge()</code> function uses two arguments: <code>x</code> and <code>y</code>. The former refers to data frame 1 and the latter to data frame 2. Both of these two data frames must have a <code>id</code> variable containing the same information. Note they can have different names. Another key argument to include is <code>all.x=TRUE</code> which tells the function to keep all the records in <code>x</code>, but only those in <code>y</code> that match in case there are discrepancies in the <code>id</code> variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># join data frames</span>
join_dfs &lt;-<span class="st"> </span><span class="kw">merge</span>(census, census2, <span class="dt">by.x=</span><span class="st">&quot;code&quot;</span>, <span class="dt">by.y=</span><span class="st">&quot;geo_code&quot;</span>, <span class="dt">all.x =</span> <span class="ot">TRUE</span>)
<span class="co"># check data</span>
<span class="kw">head</span>(join_dfs)</code></pre></div>
<pre><code>##        code                     ward pop16_74 higher_managerial   pop
## 1 E05000886 Allerton and Hunts Cross    10930              1103 14853
## 2 E05000887                  Anfield    10712               312 14510
## 3 E05000888               Belle Vale    10987               432 15004
## 4 E05000889                  Central    19174              1346 20340
## 5 E05000890                Childwall    10410              1123 13908
## 6 E05000891                   Church    10569              1843 13974
##   ghealth per_ghealth households socialrented_households
## 1    7274   0.4897327       6359                     827
## 2    6124   0.4220538       6622                    1508
## 3    6129   0.4084911       6622                    2818
## 4   11925   0.5862832       7139                    1311
## 5    7219   0.5190538       5391                     374
## 6    7461   0.5339201       5884                     178</code></pre>
</div>
</div>
<div id="saving" class="section level2">
<h2><span class="header-section-number">3.11</span> Saving</h2>
<p>It may also be convinient to save your R projects. They contains all the objects that you have created in your workspace by using the <code>save.image( )</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save.image</span>(<span class="st">&quot;week1_envs453.RData&quot;</span>)</code></pre></div>
<p>This creates a file labelled “week1_envs453.RData” in your working directory. You can load this at a later stage using the <code>load( )</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="st">&quot;week1_envs453.RData&quot;</span>)</code></pre></div>
<p>Alternatively you can save / export your data into a <code>csv</code> file. The first argument in the function is the object name, and the second: the name of the csv we want to create.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.csv</span>(join_dfs, <span class="st">&quot;join_censusdfs.csv&quot;</span>)</code></pre></div>
</div>
<div id="spatial-data-frames" class="section level2">
<h2><span class="header-section-number">3.12</span> Spatial Data Frames</h2>
<p>A core area of this module is learning to work with spatial data in R. R has various purposedly designed <strong>packages</strong> for manipulation of spatial data and spatial analysis techniques. Various R packages exist in CRAN eg. <code>spatial</code>, <code>sgeostat</code>, <code>splancs</code>, <code>maptools</code>, <code>tmap</code>, <code>rgdal</code>, <code>spand</code> and more recent development of <code>sf</code> - see <span class="citation">Lovelace, Nowosad, and Muenchow (<a href="#ref-Lovelace_et_al_2020_book">2020</a>)</span> for a great description and historical context for some of these packages.</p>
<p>During this session, we will use <code>sf</code>.</p>
<p>We first need to import our spatial data. We will use a shapefile containing data at Output Area (OA) level for Liverpool. These data illustrates the hierarchical structure of spatial data.</p>
</div>
<div id="read-spatial-data" class="section level2">
<h2><span class="header-section-number">3.13</span> Read Spatial Data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">oa_shp &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;../san/data/census/Liverpool_OA.shp&quot;</span>)</code></pre></div>
<pre><code>## Reading layer `Liverpool_OA&#39; from data source `/Users/Franciscorowe/Dropbox/Francisco/uol/teaching/envs453/201920/lectures/san/data/census/Liverpool_OA.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 1584 features and 18 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 332390.2 ymin: 379748.5 xmax: 345636 ymax: 397980.1
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs</code></pre>
<p>Examine the input data. A spatial data frame stores a range of attributes derived from a shapefile including the <strong>geometry</strong> of features (e.g. polygon shape and location), <strong>attributes</strong> for each feature (stored in the .dbf), <a href="https://en.wikipedia.org/wiki/Map_projection">projection</a> and coordinates of the shapefile’s bounding box - for details, execute:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">?st_read</code></pre></div>
<p>You can employ the usual functions to visualise the content of the created data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># visualise variable names</span>
<span class="kw">names</span>(oa_shp)</code></pre></div>
<pre><code>##  [1] &quot;OA_CD&quot;    &quot;LSOA_CD&quot;  &quot;MSOA_CD&quot;  &quot;LAD_CD&quot;   &quot;pop&quot;      &quot;H_Vbad&quot;  
##  [7] &quot;H_bad&quot;    &quot;H_fair&quot;   &quot;H_good&quot;   &quot;H_Vgood&quot;  &quot;age_men&quot;  &quot;age_med&quot; 
## [13] &quot;age_60&quot;   &quot;S_Rent&quot;   &quot;Ethnic&quot;   &quot;illness&quot;  &quot;unemp&quot;    &quot;males&quot;   
## [19] &quot;geometry&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data structure</span>
<span class="kw">str</span>(oa_shp)</code></pre></div>
<pre><code>## Classes &#39;sf&#39; and &#39;data.frame&#39;:   1584 obs. of  19 variables:
##  $ OA_CD   : Factor w/ 1584 levels &quot;E00032987&quot;,&quot;E00032988&quot;,..: 1547 485 143 1567 980 1186 1122 889 863 433 ...
##  $ LSOA_CD : Factor w/ 298 levels &quot;E01006512&quot;,&quot;E01006513&quot;,..: 291 96 33 124 187 231 220 175 173 83 ...
##  $ MSOA_CD : Factor w/ 61 levels &quot;E02001347&quot;,&quot;E02001348&quot;,..: 59 12 19 23 29 20 31 14 30 10 ...
##  $ LAD_CD  : Factor w/ 1 level &quot;E08000012&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ pop     : int  185 281 208 200 321 187 395 320 316 214 ...
##  $ H_Vbad  : int  1 2 3 7 4 4 5 9 5 4 ...
##  $ H_bad   : int  2 20 10 8 10 25 19 22 25 17 ...
##  $ H_fair  : int  9 47 22 17 32 70 42 53 55 39 ...
##  $ H_good  : int  53 111 71 52 112 57 131 104 104 53 ...
##  $ H_Vgood : int  120 101 102 116 163 31 198 132 127 101 ...
##  $ age_men : num  27.9 37.7 37.1 33.7 34.2 ...
##  $ age_med : num  25 36 32 29 34 53 23 30 34 29 ...
##  $ age_60  : num  0.0108 0.1637 0.1971 0.1 0.1402 ...
##  $ S_Rent  : num  0.0526 0.176 0.0235 0.2222 0.0222 ...
##  $ Ethnic  : num  0.3514 0.0463 0.0192 0.215 0.0779 ...
##  $ illness : int  185 281 208 200 321 187 395 320 316 214 ...
##  $ unemp   : num  0.0438 0.121 0.1121 0.036 0.0743 ...
##  $ males   : int  122 128 95 120 158 123 207 164 157 94 ...
##  $ geometry:sfc_MULTIPOLYGON of length 1584; first list element: List of 1
##   ..$ :List of 1
##   .. ..$ : num [1:14, 1:2] 335106 335130 335164 335173 335185 ...
##   ..- attr(*, &quot;class&quot;)= chr  &quot;XY&quot; &quot;MULTIPOLYGON&quot; &quot;sfg&quot;
##  - attr(*, &quot;sf_column&quot;)= chr &quot;geometry&quot;
##  - attr(*, &quot;agr&quot;)= Factor w/ 3 levels &quot;constant&quot;,&quot;aggregate&quot;,..: NA NA NA NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;names&quot;)= chr  &quot;OA_CD&quot; &quot;LSOA_CD&quot; &quot;MSOA_CD&quot; &quot;LAD_CD&quot; ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># see first few observations</span>
<span class="kw">head</span>(oa_shp)</code></pre></div>
<pre><code>## Simple feature collection with 6 features and 18 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 335071.6 ymin: 389876.7 xmax: 339426.9 ymax: 394479
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +datum=OSGB36 +units=m +no_defs
##       OA_CD   LSOA_CD   MSOA_CD    LAD_CD pop H_Vbad H_bad H_fair H_good
## 1 E00176737 E01033761 E02006932 E08000012 185      1     2      9     53
## 2 E00033515 E01006614 E02001358 E08000012 281      2    20     47    111
## 3 E00033141 E01006546 E02001365 E08000012 208      3    10     22     71
## 4 E00176757 E01006646 E02001369 E08000012 200      7     8     17     52
## 5 E00034050 E01006712 E02001375 E08000012 321      4    10     32    112
## 6 E00034280 E01006761 E02001366 E08000012 187      4    25     70     57
##   H_Vgood  age_men age_med     age_60     S_Rent     Ethnic illness
## 1     120 27.94054      25 0.01081081 0.05263158 0.35135135     185
## 2     101 37.71174      36 0.16370107 0.17600000 0.04626335     281
## 3     102 37.08173      32 0.19711538 0.02352941 0.01923077     208
## 4     116 33.73000      29 0.10000000 0.22222222 0.21500000     200
## 5     163 34.19003      34 0.14018692 0.02222222 0.07788162     321
## 6      31 56.09091      53 0.44919786 0.88524590 0.11764706     187
##        unemp males                       geometry
## 1 0.04379562   122 MULTIPOLYGON (((335106.3 38...
## 2 0.12101911   128 MULTIPOLYGON (((335810.5 39...
## 3 0.11214953    95 MULTIPOLYGON (((336738 3931...
## 4 0.03597122   120 MULTIPOLYGON (((335914.5 39...
## 5 0.07428571   158 MULTIPOLYGON (((339325 3914...
## 6 0.44615385   123 MULTIPOLYGON (((338198.1 39...</code></pre>
<p><strong>TASK:</strong></p>
<ul>
<li>What are the geographical hierarchy in these data?</li>
<li>What is the smallest geography?</li>
<li>What is the largest geography?</li>
</ul>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-grolemund_wickham_2019_book">
<p>Grolemund, Garrett, and Hadley Wickham. 2019. <em>R for Data Science</em>. O’Reilly, US. <a href="https://r4ds.had.co.nz" class="uri">https://r4ds.had.co.nz</a>.</p>
</div>
<div id="ref-Lovelace_et_al_2020_book">
<p>Lovelace, Robin, Jakub Nowosad, and Jannes Muenchow. 2020. <em>An Introduction to Statistical Learning</em>. Vol. 112. CRC Press, R Series. <a href="https://geocompr.robinlovelace.net" class="uri">https://geocompr.robinlovelace.net</a>.</p>
</div>
<div id="ref-Xie_et_al_2019_book">
<p>Xie, Yihui, JJ Allaire, and Garrett Grolemund. 2019. <em>R Markdown: The Definitive Guide</em>. CRC Press, Taylor &amp; Francis, Chapman &amp; Hall Book. <a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basic-mapping.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["spatial_analysis_notes.pdf", "spatial_analysis_notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
