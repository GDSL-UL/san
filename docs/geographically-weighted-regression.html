<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Geographically Weighted Regression | Spatial Analysis Notes</title>
  <meta name="description" content="Materials for a Spatial Analysis course in R." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Geographically Weighted Regression | Spatial Analysis Notes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Materials for a Spatial Analysis course in R." />
  <meta name="github-repo" content="gdsl-ul/san" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Geographically Weighted Regression | Spatial Analysis Notes" />
  
  <meta name="twitter:description" content="Materials for a Spatial Analysis course in R." />
  

<meta name="author" content="Francisco Rowe &amp; Dani Arribas-Bel" />


<meta name="date" content="2020-04-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multilevel-modelling-part-2.html"/>
<link rel="next" href="space-time-analysis.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Spatial Analysis Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Spatial Analysis Notes</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#dependencies"><i class="fa fa-check"></i><b>2.1</b> Dependencies</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#introducing-r"><i class="fa fa-check"></i><b>2.2</b> Introducing R</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#setting-the-working-directory"><i class="fa fa-check"></i><b>2.3</b> Setting the working directory</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#r-scripts-and-notebooks"><i class="fa fa-check"></i><b>2.4</b> R Scripts and Notebooks</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#getting-help"><i class="fa fa-check"></i><b>2.5</b> Getting Help</a></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#variables-and-objects"><i class="fa fa-check"></i><b>2.6</b> Variables and objects</a><ul>
<li class="chapter" data-level="2.6.1" data-path="intro.html"><a href="intro.html#basic-data-types"><i class="fa fa-check"></i><b>2.6.1</b> Basic Data Types</a></li>
<li class="chapter" data-level="2.6.2" data-path="intro.html"><a href="intro.html#random-variables"><i class="fa fa-check"></i><b>2.6.2</b> Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#data-frames"><i class="fa fa-check"></i><b>2.7</b> Data Frames</a><ul>
<li class="chapter" data-level="2.7.1" data-path="intro.html"><a href="intro.html#creating-a-data-frame"><i class="fa fa-check"></i><b>2.7.1</b> Creating A Data Frame</a></li>
<li class="chapter" data-level="2.7.2" data-path="intro.html"><a href="intro.html#referencing-data-frames"><i class="fa fa-check"></i><b>2.7.2</b> Referencing Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#sec_readdata"><i class="fa fa-check"></i><b>2.8</b> Read Data</a><ul>
<li class="chapter" data-level="2.8.1" data-path="intro.html"><a href="intro.html#quickly-inspect-the-data"><i class="fa fa-check"></i><b>2.8.1</b> Quickly inspect the data</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="intro.html"><a href="intro.html#manipulation-data"><i class="fa fa-check"></i><b>2.9</b> Manipulation Data</a><ul>
<li class="chapter" data-level="2.9.1" data-path="intro.html"><a href="intro.html#adding-new-variables"><i class="fa fa-check"></i><b>2.9.1</b> Adding New Variables</a></li>
<li class="chapter" data-level="2.9.2" data-path="intro.html"><a href="intro.html#selecting-variables"><i class="fa fa-check"></i><b>2.9.2</b> Selecting Variables</a></li>
<li class="chapter" data-level="2.9.3" data-path="intro.html"><a href="intro.html#filtering-data"><i class="fa fa-check"></i><b>2.9.3</b> Filtering Data</a></li>
<li class="chapter" data-level="2.9.4" data-path="intro.html"><a href="intro.html#joining-data-drames"><i class="fa fa-check"></i><b>2.9.4</b> Joining Data Drames</a></li>
<li class="chapter" data-level="2.9.5" data-path="intro.html"><a href="intro.html#saving-data"><i class="fa fa-check"></i><b>2.9.5</b> Saving Data</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="intro.html"><a href="intro.html#using-spatial-data-frames"><i class="fa fa-check"></i><b>2.10</b> Using Spatial Data Frames</a><ul>
<li class="chapter" data-level="2.10.1" data-path="intro.html"><a href="intro.html#read-spatial-data"><i class="fa fa-check"></i><b>2.10.1</b> Read Spatial Data</a></li>
<li class="chapter" data-level="2.10.2" data-path="intro.html"><a href="intro.html#basic-mapping"><i class="fa fa-check"></i><b>2.10.2</b> Basic Mapping</a></li>
<li class="chapter" data-level="2.10.3" data-path="intro.html"><a href="intro.html#comparing-geographies"><i class="fa fa-check"></i><b>2.10.3</b> Comparing geographies</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="intro.html"><a href="intro.html#useful-functions"><i class="fa fa-check"></i><b>2.11</b> Useful Functions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="points.html"><a href="points.html"><i class="fa fa-check"></i><b>3</b> Points</a><ul>
<li class="chapter" data-level="3.1" data-path="points.html"><a href="points.html#dependencies-1"><i class="fa fa-check"></i><b>3.1</b> Dependencies</a></li>
<li class="chapter" data-level="3.2" data-path="points.html"><a href="points.html#data"><i class="fa fa-check"></i><b>3.2</b> Data</a></li>
<li class="chapter" data-level="3.3" data-path="points.html"><a href="points.html#kde"><i class="fa fa-check"></i><b>3.3</b> KDE</a><ul>
<li class="chapter" data-level="3.3.1" data-path="points.html"><a href="points.html#one-dimensional-kde"><i class="fa fa-check"></i><b>3.3.1</b> One-dimensional KDE</a></li>
<li class="chapter" data-level="3.3.2" data-path="points.html"><a href="points.html#two-dimensional-spatial-kde"><i class="fa fa-check"></i><b>3.3.2</b> Two-dimensional (spatial) KDE</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="points.html"><a href="points.html#spatial-interpolation"><i class="fa fa-check"></i><b>3.4</b> Spatial Interpolation</a><ul>
<li class="chapter" data-level="3.4.1" data-path="points.html"><a href="points.html#inverse-distance-weight-idw-interpolation"><i class="fa fa-check"></i><b>3.4.1</b> Inverse Distance Weight (IDW) interpolation</a></li>
<li class="chapter" data-level="3.4.2" data-path="points.html"><a href="points.html#a-surface-of-housing-prices"><i class="fa fa-check"></i><b>3.4.2</b> A surface of housing prices</a></li>
<li class="chapter" data-level="3.4.3" data-path="points.html"><a href="points.html#what-should-the-next-houses-price-be"><i class="fa fa-check"></i><b>3.4.3</b> <em>“What should the next house’s price be?”</em></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="flows.html"><a href="flows.html"><i class="fa fa-check"></i><b>4</b> Flows</a><ul>
<li class="chapter" data-level="4.1" data-path="flows.html"><a href="flows.html#dependencies-2"><i class="fa fa-check"></i><b>4.1</b> Dependencies</a></li>
<li class="chapter" data-level="4.2" data-path="flows.html"><a href="flows.html#data-1"><i class="fa fa-check"></i><b>4.2</b> Data</a></li>
<li class="chapter" data-level="4.3" data-path="flows.html"><a href="flows.html#seeing-flows"><i class="fa fa-check"></i><b>4.3</b> “<em>Seeing</em>” flows</a></li>
<li class="chapter" data-level="4.4" data-path="flows.html"><a href="flows.html#modelling-flows"><i class="fa fa-check"></i><b>4.4</b> Modelling flows</a></li>
<li class="chapter" data-level="4.5" data-path="flows.html"><a href="flows.html#predicting-flows"><i class="fa fa-check"></i><b>4.5</b> Predicting flows</a></li>
<li class="chapter" data-level="4.6" data-path="flows.html"><a href="flows.html#references"><i class="fa fa-check"></i><b>4.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html"><i class="fa fa-check"></i><b>5</b> Spatial Econometrics</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#dependencies-3"><i class="fa fa-check"></i><b>5.1</b> Dependencies</a></li>
<li class="chapter" data-level="5.2" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#data-2"><i class="fa fa-check"></i><b>5.2</b> Data</a></li>
<li class="chapter" data-level="5.3" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#non-spatial-regression-a-refresh"><i class="fa fa-check"></i><b>5.3</b> Non-spatial regression, a refresh</a></li>
<li class="chapter" data-level="5.4" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#spatial-regression-a-very-first-dip"><i class="fa fa-check"></i><b>5.4</b> Spatial regression: a (very) first dip</a></li>
<li class="chapter" data-level="5.5" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#spatial-heterogeneity"><i class="fa fa-check"></i><b>5.5</b> Spatial heterogeneity</a></li>
<li class="chapter" data-level="5.6" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#spatial-dependence"><i class="fa fa-check"></i><b>5.6</b> Spatial dependence</a></li>
<li class="chapter" data-level="5.7" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#predicting-house-prices"><i class="fa fa-check"></i><b>5.7</b> Predicting house prices</a></li>
<li class="chapter" data-level="5.8" data-path="spatial-econometrics.html"><a href="spatial-econometrics.html#references-1"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html"><i class="fa fa-check"></i><b>6</b> Multilevel Modelling - Part 1</a><ul>
<li class="chapter" data-level="6.1" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#dependencies-4"><i class="fa fa-check"></i><b>6.1</b> Dependencies</a></li>
<li class="chapter" data-level="6.2" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#data-3"><i class="fa fa-check"></i><b>6.2</b> Data</a></li>
<li class="chapter" data-level="6.3" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#modelling"><i class="fa fa-check"></i><b>6.3</b> Modelling</a><ul>
<li class="chapter" data-level="6.3.1" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#baseline-linear-regression-model"><i class="fa fa-check"></i><b>6.3.1</b> Baseline Linear Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#multilevel-modelling-random-intercept-model"><i class="fa fa-check"></i><b>6.4</b> Multilevel Modelling: Random Intercept Model</a><ul>
<li class="chapter" data-level="6.4.1" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#interpretation"><i class="fa fa-check"></i><b>6.4.1</b> Interpretation</a></li>
<li class="chapter" data-level="6.4.2" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#variance-partition-coefficient-vpc"><i class="fa fa-check"></i><b>6.4.2</b> Variance Partition Coefficient (VPC)</a></li>
<li class="chapter" data-level="6.4.3" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#uncertainty-of-estimates"><i class="fa fa-check"></i><b>6.4.3</b> Uncertainty of Estimates</a></li>
<li class="chapter" data-level="6.4.4" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#assessing-group-level-variation"><i class="fa fa-check"></i><b>6.4.4</b> Assessing Group-level Variation</a></li>
<li class="chapter" data-level="6.4.5" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#adding-individual-level-predictors"><i class="fa fa-check"></i><b>6.4.5</b> Adding Individual-level Predictors</a></li>
<li class="chapter" data-level="6.4.6" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#adding-group-level-predictors"><i class="fa fa-check"></i><b>6.4.6</b> Adding Group-level Predictors</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="multilevel-modelling-part-1.html"><a href="multilevel-modelling-part-1.html#useful-functions-1"><i class="fa fa-check"></i><b>6.5</b> Useful Functions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html"><i class="fa fa-check"></i><b>7</b> Multilevel Modelling - Part 2</a><ul>
<li class="chapter" data-level="7.1" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#dependencies-5"><i class="fa fa-check"></i><b>7.1</b> Dependencies</a></li>
<li class="chapter" data-level="7.2" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#data-4"><i class="fa fa-check"></i><b>7.2</b> Data</a></li>
<li class="chapter" data-level="7.3" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#conceptual-overview"><i class="fa fa-check"></i><b>7.3</b> Conceptual Overview</a><ul>
<li class="chapter" data-level="7.3.1" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#exploratory-analysis-varying-slopes"><i class="fa fa-check"></i><b>7.3.1</b> Exploratory Analysis: Varying Slopes</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#estimating-varying-intercept-and-slopes-models"><i class="fa fa-check"></i><b>7.4</b> Estimating Varying Intercept and Slopes Models</a></li>
<li class="chapter" data-level="7.5" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#interpreting-correlations-between-group-level-intercepts-and-slopes"><i class="fa fa-check"></i><b>7.5</b> Interpreting Correlations Between Group-level Intercepts and Slopes</a></li>
<li class="chapter" data-level="7.6" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#model-building"><i class="fa fa-check"></i><b>7.6</b> Model building</a><ul>
<li class="chapter" data-level="7.6.1" data-path="multilevel-modelling-part-2.html"><a href="multilevel-modelling-part-2.html#model-comparison"><i class="fa fa-check"></i><b>7.6.1</b> Model Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html"><i class="fa fa-check"></i><b>8</b> Geographically Weighted Regression</a><ul>
<li class="chapter" data-level="8.1" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#dependencies-6"><i class="fa fa-check"></i><b>8.1</b> Dependencies</a></li>
<li class="chapter" data-level="8.2" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#data-5"><i class="fa fa-check"></i><b>8.2</b> Data</a></li>
<li class="chapter" data-level="8.3" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#recap-spatial-effects"><i class="fa fa-check"></i><b>8.3</b> Recap: Spatial Effects</a></li>
<li class="chapter" data-level="8.4" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#exploratory-analysis"><i class="fa fa-check"></i><b>8.4</b> Exploratory Analysis</a></li>
<li class="chapter" data-level="8.5" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#global-regression"><i class="fa fa-check"></i><b>8.5</b> Global Regression</a><ul>
<li class="chapter" data-level="8.5.1" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#global-regression-results"><i class="fa fa-check"></i><b>8.5.1</b> Global Regression Results</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#fitting-a-geographically-weighted-regression"><i class="fa fa-check"></i><b>8.6</b> Fitting a Geographically Weighted Regression</a><ul>
<li class="chapter" data-level="8.6.1" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#fixed-or-adaptive-kernel"><i class="fa fa-check"></i><b>8.6.1</b> Fixed or Adaptive Kernel</a></li>
<li class="chapter" data-level="8.6.2" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#optimal-bandwidth"><i class="fa fa-check"></i><b>8.6.2</b> Optimal Bandwidth</a></li>
<li class="chapter" data-level="8.6.3" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#shape-of-spatial-kernel"><i class="fa fa-check"></i><b>8.6.3</b> Shape of Spatial Kernel</a></li>
<li class="chapter" data-level="8.6.4" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#selecting-a-bandwidth"><i class="fa fa-check"></i><b>8.6.4</b> Selecting a Bandwidth</a></li>
<li class="chapter" data-level="8.6.5" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#model-fit"><i class="fa fa-check"></i><b>8.6.5</b> Model fit</a></li>
<li class="chapter" data-level="8.6.6" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#interpretation-1"><i class="fa fa-check"></i><b>8.6.6</b> Interpretation</a></li>
<li class="chapter" data-level="8.6.7" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#assessing-statistical-significance"><i class="fa fa-check"></i><b>8.6.7</b> Assessing statistical significance</a></li>
<li class="chapter" data-level="8.6.8" data-path="geographically-weighted-regression.html"><a href="geographically-weighted-regression.html#collinearity-in-gwr"><i class="fa fa-check"></i><b>8.6.8</b> Collinearity in GWR</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="space-time-analysis.html"><a href="space-time-analysis.html"><i class="fa fa-check"></i><b>9</b> Space-Time Analysis</a></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Spatial Analysis Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="geographically-weighted-regression" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Geographically Weighted Regression</h1>
<p>This chapter<a href="#fn45" class="footnoteRef" id="fnref45"><sup>45</sup></a> provides an introduction to geographically weighted regression models.</p>
<p>The content of this chapter is based on:</p>
<ul>
<li><p><span class="citation">Fotheringham, Brunsdon, and Charlton (<a href="#ref-Fotheringham_et_al_2002_book">2002</a>)</span>, an must-go book if you are working or planning to start working on geographically weighted regression modelling.</p></li>
<li><p><span class="citation">Comber et al. (<a href="#ref-comber2020gwr">2020</a>)</span> is recently published preprint which provides a roadmap to approach various practical issues in the application of GWR.</p></li>
</ul>
<p>This Chapter is part of <a href="index.html">Spatial Analysis Notes</a>, a compilation hosted as a GitHub repository that you can access it in a few ways:</p>
<ul>
<li>As a <a href="https://github.com/GDSL-UL/san/archive/master.zip">download</a> of a <code>.zip</code> file that contains all the materials.</li>
<li>As an <a href="https://gdsl-ul.github.io/san/geographically-weighted-regression.html">html website</a>.</li>
<li>As a <a href="https://gdsl-ul.github.io/san/spatial_analysis_notes.pdf">pdf document</a></li>
<li>As a <a href="https://github.com/GDSL-UL/san">GitHub repository</a>.</li>
</ul>
<div id="dependencies-6" class="section level2">
<h2><span class="header-section-number">8.1</span> Dependencies</h2>
<p>This chapter uses the following libraries: Ensure they are installed on your machine<a href="#fn46" class="footnoteRef" id="fnref46"><sup>46</sup></a> before loading them executing the following code chunk:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Data manipulation, transformation and visualisation</span>
<span class="kw">library</span>(tidyverse)
<span class="co"># Nice tables</span>
<span class="kw">library</span>(kableExtra)
<span class="co"># Simple features (a standardised way to encode vector data ie. points, lines, polygons)</span>
<span class="kw">library</span>(sf) 
<span class="co"># Spatial objects conversion</span>
<span class="kw">library</span>(sp) 
<span class="co"># Thematic maps</span>
<span class="kw">library</span>(tmap) 
<span class="co"># Colour palettes</span>
<span class="kw">library</span>(RColorBrewer) 
<span class="co"># More colour palettes</span>
<span class="kw">library</span>(viridis) <span class="co"># nice colour schemes</span>
<span class="co"># Fitting geographically weighted regression models</span>
<span class="kw">library</span>(spgwr)
<span class="co"># Obtain correlation coefficients</span>
<span class="kw">library</span>(corrplot)
<span class="co"># Exportable regression tables</span>
<span class="kw">library</span>(jtools)
<span class="kw">library</span>(stargazer)
<span class="kw">library</span>(sjPlot)
<span class="co"># Assess multicollinearity</span>
<span class="kw">library</span>(car)</code></pre></div>
</div>
<div id="data-5" class="section level2">
<h2><span class="header-section-number">8.2</span> Data</h2>
<p>For this chapter, we will data on:</p>
<ul>
<li><p>cummulative COVID-19 confirmed cases from 1st January, 2020 to 14th April, 2020 from Public Health England via the <a href="https://coronavirus.data.gov.uk">GOV.UK dashboard</a>;</p></li>
<li><p>resident population characteristics from the 2011 census data from the <a href="https://www.nomisweb.co.uk/home/census2001.asp">Office of National Statistics</a>; and,</p></li>
<li><p>2019 index of multiple deprivation data from <a href="https://www.gov.uk/government/statistics/english-indices-of-deprivation-2019">GOV.UK</a> and published by the Ministry of Housing, Communities &amp; Local Government. The data are at the ONS Upper Tier Local Authority (UTLA) - also known as <a href="https://ago-item-storage.s3.us-east-1.amazonaws.com/7bb8db84e0f54e83aa05204f7bd674b8/EN37152_CTY_UA_DEC_2018_UK.pdf?X-Amz-Security-Token=IQoJb3JpZ2luX2VjEI7%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FwEaCXVzLWVhc3QtMSJHMEUCIHGIIjyriwWRx5QXeakP%2BhJr39uh7b7jP1dr4q%2FbEgC3AiEA0ohlaSFkwlCKLMy3vFhZDcQvDgzEVEP0kS17VN2ZnxMqvQMIpv%2F%2F%2F%2F%2F%2F%2F%2F%2F%2FARAAGgw2MDQ3NTgxMDI2NjUiDD2XGTMX5p%2BWiurX2iqRA%2FHRJfiW8YaOjNi65RC8AFZ5shx%2Fn3Upl%2B9YP5xhX4YzsRqkYkx%2FYkwbMZ%2FlDDqWpBHcZzoRdFDz1IGLueQJvDhFignjzIBmExSJ0UdMvuU56tXbnZQ%2BI8lTjP9JRtLpZELENSjVeoi5qJpphGzoBo9O9cCJkQvWC3NNxqV6eFez00ld5qlRMpJ4KTOl7%2FxJBBfua%2F8WYdrcZ4H0KA47l%2FIJnp2AklUv%2Fw0cBoU0LZq3djjuVlE%2FseJKOnm1Z8KMFItEanYUpOrMfROJ5C%2FTwqqJ2GQMSvr30W%2F4%2FY%2F2BKNTiyCvbEJnD03SWrB20bBlN0Gr13YYvcSBBjgwmhe4EKIrrLSKo8SOZNOg02nq%2Bmrc0%2FsPo%2BYyLgA0MXASt9kDPL4N5IF9yG3lS7vd7E7%2FpesIlC%2FW3g3TVOBA92bKMtU6QA%2B93URcqkrXyrvN6LGAt2C83HjvuAmtbSmlJOD5enC7abdOEqJMyJdUH%2BwbBKXN8TK%2F%2BbRMzgshl1dJElvSnPAYZEuNwaso8bVXwSK%2F31m6MP%2Bv4fQFOusBk4G2Dlca6chTsAlFjXomtOeu6Kxm0MRAgdhF4mSRnKggkWu8mBYY68%2BeGt3egIOtssrEVcWYr1nseCriPHpsA%2BGi3IFnyPVIKZpStdv%2F%2FNoOip3YGsb%2BSxgkIdxjVJdnkTsEvEf7AZtu6BFTKfTtTAII%2Boh46F%2BH%2FDztv9kHuQMMXQsJozbphriOJDxP8TMSe16v8Tc1yULmRuenrfX1CMGTPrTcoUYPEu82qwDWlcMWwRRTMAv3xcupkZXVOQhMzkcyOOxQdOLWyIH5%2FZ%2BuIkNMQzndBya5nNjpGJ6UniQp22CkZ5n52KK%2Fnw%3D%3D&amp;X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Date=20200416T135331Z&amp;X-Amz-SignedHeaders=host&amp;X-Amz-Expires=300&amp;X-Amz-Credential=ASIAYZTTEKKEUJMS7TPU%2F20200416%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Signature=02022ae0228c2fc1d09a90a389d7fd00b9de38ff2df002159d3ad84666c213e8">Counties and Unitary Authorities</a>.</p></li>
</ul>
<p>If you use the dataset utilised in this chapter, cite this book. For a full list of the variables included in the data set we will use in this chapter, see the readme file in the gwr data folder.<a href="#fn47" class="footnoteRef" id="fnref47"><sup>47</sup></a></p>
<p>Let’s read the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># clean workspace</span>
<span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>())
<span class="co"># read data</span>
utla_shp &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/gwr/Covid19_total_cases_geo.shp&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(objct, cty19c, ctyu19nm, long, lat, st_rs, st_ln, X2020.<span class="fl">04.14</span>, I.PL1, IMD20, IMD2., Rsdnt, Hshld, Dwlln, Hsh_S, E_16_, A_65_, Ag_<span class="dv">85</span>, Mixed, Indin, Pkstn, Bngld, Chins, Oth_A, Black, Othr_t, CB_U_, Crwd_, Lng__, Trn__, Adm__, Ac___, Pb___, Edctn, H____, geometry)

<span class="co"># replace nas with 0s</span>
utla_shp[<span class="kw">is.na</span>(utla_shp)] &lt;-<span class="st"> </span><span class="dv">0</span>
<span class="co"># explore data</span>
<span class="kw">str</span>(utla_shp)</code></pre></div>
</div>
<div id="recap-spatial-effects" class="section level2">
<h2><span class="header-section-number">8.3</span> Recap: Spatial Effects</h2>
<p>To this point, we have implicitly discussed three distinctive spatial effects:</p>
<ul>
<li><p><em>Spatial heterogeneity</em> refers to the uneven distribution of a variable’s values across space</p></li>
<li><p><em>Spatial dependence</em> refers to the spatial relationship of a variable’s values for a pairs of locations at a certain distance apart, so that are more similar (or less similar) than expected for randomly associated pairs of observations</p></li>
<li><p><em>Spatial nonstationarity</em> refers to variations in the relationship between an outcome variable and a set of predictor variables across space</p></li>
</ul>
<p>In previous sessions, we considered multilevel models to deal with spatial nonstationarity, recognising that the strength and direction of the relationship between an outcome <span class="math inline">\(y\)</span> and a set of predictors <span class="math inline">\(x\)</span> may vary over space. Here we consider a different approach, namely geographically weighted regression (GWR).</p>
</div>
<div id="exploratory-analysis" class="section level2">
<h2><span class="header-section-number">8.4</span> Exploratory Analysis</h2>
<p>We will explore this technique through an empirical analysis considering the current global COVID-19 outbreak. Specifically we will seek to identify potential contextual factors that may be related to an increased risk of local infection. Population density, housing overcrowding, vulnerable individuals and critical workers have been linked to a higher risk of COVID-19 infections.</p>
<p>First, we will define and develop some basic understanding of our variable of interest. We define the risk of COVID-19 infection by the cummulative number of confirmed positive cases COVID-19 per 100,000 people:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># risk of covid-19 infection</span>
utla_shp<span class="op">$</span>covid19_r &lt;-<span class="st"> </span>(utla_shp<span class="op">$</span>X2020.<span class="fl">04.14</span> <span class="op">/</span><span class="st"> </span>utla_shp<span class="op">$</span>Rsdnt) <span class="op">*</span><span class="st"> </span><span class="dv">100000</span>

<span class="co"># histogram</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> utla_shp) <span class="op">+</span>
<span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="kw">aes</span>(<span class="dt">x =</span> covid19_r)) <span class="op">+</span>
<span class="st">   </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># distribution in numbers</span>
<span class="kw">summary</span>(utla_shp<span class="op">$</span>covid19_r)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   32.11   92.81  140.15  146.66  190.96  341.56</code></pre>
<p>The results indicate a wide variation in the risk of infection across UTLAs in England, ranging from 31 to 342 confirmed positive cases of COVID-19 per 100,000 people with a median of 147. We map the cases to understand their spatial structure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># read region boundaries for a better looking map</span>
reg_shp &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/gwr/Regions_December_2019_Boundaries_EN_BGC.shp&quot;</span>)</code></pre></div>
<pre><code>## Reading layer `Regions_December_2019_Boundaries_EN_BGC&#39; from data source `/Users/Franciscorowe/Dropbox/Francisco/uol/teaching/envs453/201920/lectures/san/data/gwr/Regions_December_2019_Boundaries_EN_BGC.shp&#39; using driver `ESRI Shapefile&#39;
## Simple feature collection with 9 features and 9 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 82672 ymin: 5342.7 xmax: 655653.8 ymax: 657536
## epsg (SRID):    27700
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +towgs84=446.448,-125.157,542.06,0.15,0.247,0.842,-20.489 +units=m +no_defs</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ensure geometry is valid</span>
utla_shp =<span class="st"> </span>lwgeom<span class="op">::</span><span class="kw">st_make_valid</span>(utla_shp)
reg_shp =<span class="st"> </span>lwgeom<span class="op">::</span><span class="kw">st_make_valid</span>(reg_shp)

<span class="co"># map</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Cummulative cases per 100,000&quot;</span>)
map_utla =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;covid19_r&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_utla <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span></code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>The map shows that concentrations of high incidence of infections in the metropolitan areas of London, Liverpool, Newcastle, Sheffield, Middlesbrough and Birmingham. Below we list the UTLAs in these areas in descending order.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hotspots &lt;-<span class="st"> </span>utla_shp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(ctyu19nm, covid19_r) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(covid19_r <span class="op">&gt;</span><span class="st"> </span><span class="dv">190</span>)
hotspots[<span class="kw">order</span>(<span class="op">-</span>hotspots<span class="op">$</span>covid19_r),]</code></pre></div>
<pre><code>## Simple feature collection with 38 features and 2 fields
## geometry type:  MULTIPOLYGON
## dimension:      XY
## bbox:           xmin: 293941.4 ymin: 155850.8 xmax: 561956.7 ymax: 588517.4
## epsg (SRID):    NA
## proj4string:    +proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +units=m +no_defs
## First 10 features:
##     ctyu19nm covid19_r                       geometry
## 14     Brent  341.5645 MULTIPOLYGON (((520113.1 19...
## 32 Southwark  337.1687 MULTIPOLYGON (((532223 1805...
## 27   Lambeth  305.5238 MULTIPOLYGON (((531189.5 18...
## 22    Harrow  286.1254 MULTIPOLYGON (((517363.8 19...
## 17   Croydon  276.8467 MULTIPOLYGON (((531549.3 17...
## 12    Barnet  274.1410 MULTIPOLYGON (((524645.2 19...
## 28  Lewisham  261.3408 MULTIPOLYGON (((536691.6 17...
## 30    Newham  258.4550 MULTIPOLYGON (((542600.7 18...
## 38   Cumbria  255.6726 MULTIPOLYGON (((357012.9 58...
## 15   Bromley  253.7234 MULTIPOLYGON (((542252.7 17...</code></pre>
<blockquote>
<p>Challenge 1: How does Liverpool ranked in this list?</p>
</blockquote>
</div>
<div id="global-regression" class="section level2">
<h2><span class="header-section-number">8.5</span> Global Regression</h2>
<p>To provide an intuitive understanding of GWR, exploring our data based on an ordinary least squares (OLS) linear regression model is a useful start. The key issue here is to understand if high incidence of COVID-19 is linked to structural differences across UTLAs in England. As indicated above, confirmed positive cases of COVID-19 have been associated with overcrowding housing, vulnerable populations - including people in elderly age groups, economically disadvantaged groups and suffering from chronic health conditions - ethnic minorities, critical workers in the health &amp; social work, education, accommodation &amp; food, transport, and administrative &amp; support sectors. So let’s create a set of variables to approximate these factors.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># define predictors</span>
utla_shp &lt;-<span class="st"> </span>utla_shp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(
  <span class="dt">crowded_hou =</span> Crwd_ <span class="op">/</span><span class="st"> </span>Hshld, <span class="co"># share of crowded housing</span>
  <span class="dt">elderly =</span> (A_65_ <span class="op">+</span><span class="st"> </span>Ag_<span class="dv">85</span>) <span class="op">/</span><span class="st"> </span>Rsdnt, <span class="co"># share of population aged 65+</span>
  <span class="dt">lt_illness =</span> Lng__ <span class="op">/</span><span class="st"> </span>Rsdnt, <span class="co"># share of population in long-term illness</span>
  <span class="dt">ethnic =</span> (Mixed <span class="op">+</span><span class="st"> </span>Indin <span class="op">+</span><span class="st"> </span>Pkstn <span class="op">+</span><span class="st"> </span>Bngld <span class="op">+</span><span class="st"> </span>Chins <span class="op">+</span><span class="st"> </span>Oth_A <span class="op">+</span><span class="st"> </span>Black <span class="op">+</span><span class="st"> </span>Othr_t) <span class="op">/</span><span class="st"> </span>Rsdnt, <span class="co"># share of nonwhite population</span>
  <span class="dt">imd19_ext =</span> IMD20, <span class="co"># proportion of a larger area’s population living in the most deprived LSOAs in the country</span>
  <span class="dt">hlthsoc_sec =</span> H____ <span class="op">/</span><span class="st"> </span>E_16_, <span class="co"># share of workforce in the human health &amp; social work sector</span>
  <span class="dt">educ_sec =</span> Edctn <span class="op">/</span><span class="st"> </span>E_16_, <span class="co"># share of workforce in the education sector</span>
  <span class="dt">trnsp_sec=</span> Trn__ <span class="op">/</span><span class="st"> </span>E_16_, <span class="co"># share of workforce in the Transport &amp; storage sector</span>
  <span class="dt">accfood_sec =</span> Ac___ <span class="op">/</span><span class="st"> </span>E_16_, <span class="co"># share of workforce in the accommodation &amp; food service sector</span>
  <span class="dt">admsupport_sec =</span> Adm__ <span class="op">/</span><span class="st">  </span>E_16_, <span class="co"># share of workforce in the administrative &amp; support sector</span>
  <span class="dt">pblic_sec =</span> Pb___ <span class="op">/</span><span class="st"> </span>E_16_ <span class="co"># share of workforce in the public administration &amp; defence sector</span>
)</code></pre></div>
<p>Let’s quickly examine how they correlate to our outcome variable i.e. incidence rate of COVID-19 using correlation coefficients and correlograms.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># obtain a matrix of Pearson correlation coefficients</span>
df_sel &lt;-<span class="st"> </span><span class="kw">st_set_geometry</span>(utla_shp[,<span class="dv">37</span><span class="op">:</span><span class="dv">48</span>], <span class="ot">NULL</span>) <span class="co"># temporary data set removing geometries</span>
cormat &lt;-<span class="st"> </span><span class="kw">cor</span>(df_sel, <span class="dt">use=</span><span class="st">&quot;complete.obs&quot;</span>, <span class="dt">method=</span><span class="st">&quot;pearson&quot;</span>)

<span class="co"># significance test</span>
sig1 &lt;-<span class="st"> </span>corrplot<span class="op">::</span><span class="kw">cor.mtest</span>(df_sel, <span class="dt">conf.level =</span> .<span class="dv">95</span>)

<span class="co"># creta a correlogram</span>
corrplot<span class="op">::</span><span class="kw">corrplot</span>(cormat, <span class="dt">type=</span><span class="st">&quot;lower&quot;</span>,
                   <span class="dt">method =</span> <span class="st">&quot;circle&quot;</span>, 
                   <span class="dt">order =</span> <span class="st">&quot;original&quot;</span>, 
                   <span class="dt">tl.cex =</span> <span class="fl">0.7</span>,
                   <span class="dt">p.mat =</span> sig1<span class="op">$</span>p, <span class="dt">sig.level =</span> .<span class="dv">05</span>, 
                   <span class="dt">col =</span> viridis<span class="op">::</span><span class="kw">viridis</span>(<span class="dv">100</span>, <span class="dt">option =</span> <span class="st">&quot;plasma&quot;</span>),
                   <span class="dt">diag =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>The correlogram shows the strength and significance of the linear relationship between our set of variables. The size of the circle reflects the strength of the relationships as captured by the Pearson correlation coefficient, and crosses indicate statistically insignificant relationships at the 95% level of confidence. The colour indicate the direction of the relationship with dark (light) colours indicating a negative (positive) association.</p>
<p>The resuls indicate that the incidence of COVID-19 is significantly and positively related to the share of crowded housing, nonwhite ethnic minorities and administrative &amp; support workers. Against the expectations, the incidence of COVID-19 appears negatively correlated to the share of elderly population, of population suffering from long-term illness and of administrative &amp; support workers, and displays no significant association with the share of population living in deprivated areas, of public administration &amp; defence, and of health &amp; social workers. The latter probably reflect the effectiveness of the protective measures undertaken to prevent infection among these population groups, but it may also reflect the partial coverage of COVID-19 testing and underreporting. It may also reveal the descriptive limitations of correlation coefficients as they show the relationship between a pairs of variables, not controling for others. Correlation coefficients can thus produce spurious relationships resulting from counfounded variables. We will return to this point below.</p>
<p>The results also reveal high collinearity between particular pairs of variables, notably between the share of crowded housing and of nonwhite ethnic population, the share of crowded housing and of elderly population, the share of crowded housing and of administrative &amp; support workers, the share of elderly population and of population suffering from long-term illness. A more refined analysis of multicollinearity is needed. Various diagnostics for multicollinearity in a regression framework exist, including matrix condition numbers (CNs), predictor variance inflation factors (VIFs) and variance decomposition factors (VDPs). Rules of thumb (CNs &gt; 30, VIFs &gt; 10 and VDPs &gt; 0.5) to indicate worrying levels of collinearity can be found <span class="citation">(Belsley, Kuh, and Welsch <a href="#ref-belsley2005regression">2005</a>)</span>. To avoid problems of multicollinearity, often a simple strategy is to remove highly correlated predictors. The difficultly is in deciding which predictor(s) to remove, especially when all are considered important. Have this in mind when specifying your model.</p>
<blockquote>
<p>Challenge 2: Analyse the relationship of all the variables executing <code>pairs(df_sel)</code>. How accurate would a linear regression be in capturing the relationships for our set of variables?</p>
</blockquote>
<div id="global-regression-results" class="section level3">
<h3><span class="header-section-number">8.5.1</span> Global Regression Results</h3>
<p>To gain a better understanding of these relationships, we can regress the incidence rate of COVID-19 on a series of factors capturing differences across areas. To focus on the description of GWR, we keep our analysis simple and study the incidence rate of COVID-19 as a function of the share of nonwhite ethnic population and of population suffering long-term illness by estimating the following OLS linear regression model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># attach data</span>
<span class="kw">attach</span>(utla_shp)

<span class="co"># specify a model equation</span>
eq1 &lt;-<span class="st"> </span>covid19_r <span class="op">~</span><span class="st"> </span>ethnic <span class="op">+</span><span class="st"> </span>lt_illness
model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> eq1, <span class="dt">data =</span> utla_shp)

<span class="co"># estimates</span>
<span class="kw">summary</span>(model1)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = eq1, data = utla_shp)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -109.234  -38.386   -4.879   29.284  143.786 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    63.77      30.13   2.117    0.036 *  
## ethnic        271.10      30.65   8.845 2.64e-15 ***
## lt_illness    216.20     151.88   1.424    0.157    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 51 on 147 degrees of freedom
## Multiple R-squared:  0.3926, Adjusted R-squared:  0.3844 
## F-statistic: 47.52 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We also compute the VIFs for the variables in the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vif</span>(model1)</code></pre></div>
<pre><code>##     ethnic lt_illness 
##    1.43015    1.43015</code></pre>
<p>The regression results indicate a positive relationship exists between the share of nonwhite population and an increased risk of COVID-19 infection. A one percentage point increase in the share of nonwhite population returns a 271 rise in the cummulative count of COVID-19 infection per 100,000 people, everything else constant. The results also reveal a positive (albeit statistically insignificant) relationship between the share of population suffering from long-term illness and an increased risk of COVID-19 infection, after controlling for the share of nonwhite population, confirming the suspicion of the limitations of correlation coefficients; that is, once differences in the share of nonwhite population are taken into account, the association between the share of population suffering from long-term illness and an increased risk of COVID-19 infection becomes positive. We also test for multicollinearity. The VIFs are below 10 indicating that multicollinearity is not highly problematic.</p>
<p>The <span class="math inline">\(R^{2}\)</span> value for the OLS regression is 0.393 indicating that our model explains only 39% of the variance in the rate of COVID-19 infection. This leaves 71% of the variance unexplained. Some of this unexplained variance can be because we have only included two explanatory variables in our model, but also because the OLS regression model assumes that the relationships in the model are constant over space; that is, it assumes a stationary process. Hence, an OLS regression model is considered to capture global relationships. However, relationships may vary over space. Suppose, for instance, that there are intrinsic behavioural variations across England and that people have adhered more strictly to self-isolation and social distancing measures in some areas than in others, or that ethnic minorities are less exposed to contracting COVID-19 in certain parts of England. If such variations in associations exist over space, our estimated OLS model will be a misspecification of reality because it assumes these relationships to be constant.</p>
<p>To better understand this potential misspecification, we investigate the model redisuals which show high variability. The distribution is non-random displaying large positive residuals in the metropolitan areas of London, Liverpool, Newcastle (in light colours) and the Lake District and large negative residuals across much of England (in black). This conforms to the spatial pattern of confirmed COVID-19 cases with high concentration in a limited number of metropolitan areas (see above). While our residual map reveals that there is a problem with the OLS model, it does not indicate which, if any, of the parameters in the model might exhibit spatial nonstationarity. A simple way of examining if the relationships being modelled in our global OLS model are likely to be stationary over space would be to estimate separate OLS model for each UTLA in England. But this would require higher resolution i.e. data within UTLA, and we only have one data point per UTLA. <span class="citation">Fotheringham, Brunsdon, and Charlton (<a href="#ref-Fotheringham_et_al_2002_book">2002</a>)</span> (2002, p.40-44) discuss alternative approaches and their limitations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">utla_shp<span class="op">$</span>res_m1 &lt;-<span class="st"> </span><span class="kw">residuals</span>(model1)

<span class="co"># map</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;OLS residuals&quot;</span>)
map_utla =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;res_m1&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_utla <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span></code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
</div>
<div id="fitting-a-geographically-weighted-regression" class="section level2">
<h2><span class="header-section-number">8.6</span> Fitting a Geographically Weighted Regression</h2>
<p>GWR overcomes the limitation of the OLS regression model of generating a global set of estimates. The basic idea behind GWR is to examine the way in which the relationships between a dependent variable and a set of predictors might vary over space. GWR operates by moving a search window from one regression point to the next, working sequentially through all the existing regression points in the dataset. A set of regions is then defined around each regression point and within the search window. A regression model is then fitted to all data contained in each of the identified regions around a regression point, with data points closer to the sample point being weighted more heavily than are those farther away. This process is repeated for all samples points in the dataset. For a data set of 150 observations GWR will fit 150 weighted regression models. The resulting local estimates can then be mapped at the locations of the regression points to view possible variations in the relationships between variables.</p>
<p>Graphically, GWR involves fitting a spatial kernel to the data as described in the Fig. 1. For a given regression point <span class="math inline">\(X\)</span>, the weight (<span class="math inline">\(W\)</span>) of a data point is at a maximum at the location of the regression point. The weight decreases gradually as the distance between two points increases. A regression model is thus calibrated locally by moving the regression point across the area under study. For each location, the data are weighted differently so that the resulting estimates are unique to a particular location.</p>
<div class="figure">
<img src="figs/ch8/fixed_bandwidth.png" alt="Fig. 1. GWR with fixed spatial kernel. Source: Fotheringham, Brunsdon, and Charlton (2002) (2002, p.45)." />
<p class="caption">Fig. 1. GWR with fixed spatial kernel. Source: <span class="citation">Fotheringham, Brunsdon, and Charlton (<a href="#ref-Fotheringham_et_al_2002_book">2002</a>)</span> (2002, p.45).</p>
</div>
<div id="fixed-or-adaptive-kernel" class="section level3">
<h3><span class="header-section-number">8.6.1</span> Fixed or Adaptive Kernel</h3>
<p>A key issue is to decide between two options of spatial kernels: a fixed kernel or an adaptive kernel. Intuitively, a fixed kernel involves using a fixed bandwidth to define a region around all regression points as displayed in Fig. 1. The extent of the kernel is determined by the distance to a given regression point, with the kernel being identical at any point in space. An adaptive kernel involves using varying bandwidth to define a region around regression points as displayed in Fig. 2. The extent of the kernel is determined by the number of nearest neighbours from a given regression point. The hernels have larger bandwidths where the data are sparse.</p>
<div class="figure">
<img src="figs/ch8/adaptive_bandwidth.png" alt="Fig. 2. GWR with adaptive spatial kernel. Source: Fotheringham, Brunsdon, and Charlton (2002) (2002, p.47)." />
<p class="caption">Fig. 2. GWR with adaptive spatial kernel. Source: <span class="citation">Fotheringham, Brunsdon, and Charlton (<a href="#ref-Fotheringham_et_al_2002_book">2002</a>)</span> (2002, p.47).</p>
</div>
</div>
<div id="optimal-bandwidth" class="section level3">
<h3><span class="header-section-number">8.6.2</span> Optimal Bandwidth</h3>
<p>A second issue is to define the extent of geographical area (i.e. <em>optimal bandwidth</em>) of the spatial kernel. The bandwidth is the distance beyond which a value of zero is assigned to weight observations. Larger bandwidths include a larger number of observations receiving a non-zero weight and more observations are used to fit a local regression.</p>
<p>To determine the optimal bandwidth, a cross-validation approach is applied; that is, for a location, a local regression is fitted based on a given bandwidth and used to predict the value of the dependent variable. The resulting predicted value is used to compute the residuals of the model. Residuals are compared using a series of bandwidth and the bandwidth returning the smallest local residuals are selected.</p>
<p>** Variance and Bias Trade off **</p>
<p>Choosing an optimal bandwidth involves a compromise between bias and precision. For example, a larger bandwidth will involve using a larger number of observations to fit a local regression, and hence result in reduced variance (or increased precision) but high bias of estimates. On the other hand, too small bandwidth involves using a very small number of observations resulting in increased variance but small bias. An optimal bandwidth offers a compromise between bias and variance.</p>
</div>
<div id="shape-of-spatial-kernel" class="section level3">
<h3><span class="header-section-number">8.6.3</span> Shape of Spatial Kernel</h3>
<p>Two general set of kernel functions can be distinguished: continuous kernels and kernels with compact support. Continuous kernels are used to weight all observations in the study area and includes uniform, Gaussian and Exponetial kernel functions. Kernel with compact support are used to assign a nonzero weight to observations within a certain distance and a zero weight beyond it. The shape of the kernel has been reported to cause small changes to resulting estimates <span class="citation">(Brunsdon, Fotheringham, and Charlton <a href="#ref-brunsdon1998geographically">1998</a>)</span>.</p>
</div>
<div id="selecting-a-bandwidth" class="section level3">
<h3><span class="header-section-number">8.6.4</span> Selecting a Bandwidth</h3>
<p>Let’s now implement a GWR model. The first key step is to define the optimal bandwidth. We first illustrate the use of a fixed spatial kernel.</p>
<div id="fixed-bandwidth" class="section level4">
<h4><span class="header-section-number">8.6.4.1</span> Fixed Bandwidth</h4>
<p>Cross-validation is used to search for the optimal bandwidth. Recall that this procedure compares the model residuals based on different bandwidths and chooses the optimal solution i.e. the bandwidth returning the smallest model residuls based on a given model specification. A key parameter here is the shape of the geographical weight function (<code>gweight</code>). We set it to be a Gaussian function which is the default. A bi-square function is recommended to reduce computational time. Since we have a simple model, a Gaussian function should not take that long. Note that we set the argument <code>longlat</code> to <code>TRUE</code> and use latitude and longitude for coordinates (<code>coords</code>). When <code>longlat</code> is set to <code>TRUE</code>, distances are measured in kilometers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># find optimal kernel bandwidth using cross validation</span>
fbw &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(eq1, 
               <span class="dt">data =</span> utla_shp, 
               <span class="dt">coords=</span><span class="kw">cbind</span>( lat, long),
               <span class="dt">longlat =</span> <span class="ot">TRUE</span>,
               <span class="dt">adapt=</span><span class="ot">FALSE</span>, 
               <span class="dt">gweight =</span> gwr.Gauss, 
               <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

<span class="co"># view selected bandwidth</span>
fbw</code></pre></div>
<pre><code>## [1] 39.79709</code></pre>
<p>The result indicates that the optimal bandwidth is 39.79 kms. This means that neighbouring UTLAs within a fixed radius of 39.79 kms will be taken to estimate local regressions. To estimate a GWR, we execute the code below in which the optimal bandwidth above is used as an input in the argument <code>bandwidth</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fit a gwr based on fixed bandwidth</span>
fb_gwr &lt;-<span class="st"> </span><span class="kw">gwr</span>(eq1, 
            <span class="dt">data =</span> utla_shp,
            <span class="dt">coords=</span><span class="kw">cbind</span>( lat, long),
            <span class="dt">longlat =</span> <span class="ot">TRUE</span>,
            <span class="dt">bandwidth =</span> fbw, 
            <span class="dt">gweight =</span> gwr.Gauss,
            <span class="dt">hatmatrix=</span><span class="ot">TRUE</span>, 
            <span class="dt">se.fit=</span><span class="ot">TRUE</span>)

fb_gwr</code></pre></div>
<pre><code>## Call:
## gwr(formula = eq1, data = utla_shp, coords = cbind(lat, long), 
##     bandwidth = fbw, gweight = gwr.Gauss, hatmatrix = TRUE, longlat = TRUE, 
##     se.fit = TRUE)
## Kernel function: gwr.Gauss 
## Fixed bandwidth: 39.79709 
## Summary of GWR coefficient estimates at data points:
##                   Min.   1st Qu.    Median   3rd Qu.      Max.  Global
## X.Intercept.  -191.648   -27.948    95.366   235.818   689.921  63.768
## ethnic        -651.291   111.928   199.139   261.223  1008.347 271.096
## lt_illness   -2112.245  -735.222   131.716   660.402  1398.447 216.198
## Number of data points: 150 
## Effective number of parameters (residual: 2traceS - traceS&#39;S): 53.7278 
## Effective degrees of freedom (residual: 2traceS - traceS&#39;S): 96.2722 
## Sigma (residual: 2traceS - traceS&#39;S): 38.87087 
## Effective number of parameters (model: traceS): 41.74245 
## Effective degrees of freedom (model: traceS): 108.2576 
## Sigma (model: traceS): 36.65605 
## Sigma (ML): 31.14075 
## AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 1577.913 
## AIC (GWR p. 96, eq. 4.22): 1498.979 
## Residual sum of squares: 145462 
## Quasi-global R2: 0.768978</code></pre>
<p>We will skip the interpretation of the results for now and consider them in the next section. Now, we want to focus on the overall model fit and will map the results of the <span class="math inline">\(R^{2}\)</span> for the estimated local regressions. To do this, we extract the model results stored in a Spatial Data Frame (SDF) and add them to our spatial data frame <code>utla_shp</code>. Note that the Quasi-global <span class="math inline">\(R^{2}\)</span> is very high (0.77) indicating a high in-sample prediction accuracy.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># write gwr output into a data frame</span>
fb_gwr_out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(fb_gwr<span class="op">$</span>SDF)

utla_shp<span class="op">$</span>fmb_localR2 &lt;-<span class="st"> </span>fb_gwr_out<span class="op">$</span>localR2

<span class="co"># map</span>
  <span class="co"># Local R2</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Fixed: Local R2&quot;</span>)
map_fbgwr1 =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;fmb_localR2&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_fbgwr1 <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span></code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The map shows very high in-sample model predictions of up to 80% in relatively large UTLAs (i.e. Cornwall, Devon and Cumbria) but poor predictions in Linconshire and small UTLAs in the North West and Yorkshire &amp; The Humber Regions and the Greater London. The spatial distribution of this pattern may reflect a potential problem that arise in the application of GWR with fixed spatial kernels. The use of fixed kernels implies that local regressions for small spatial units may be calibrated on a large number of dissimilar areas, while local regressions for large areas may be calibrated on very few data points, giving rise to estimates with large standard errors. In extreme cases, generating estimates might not be possible due to insufficient variation in small samples. In practice, this issue is relatively common if the number of geographical areas in the dataset is small.</p>
</div>
<div id="adaptive-bandwidth" class="section level4">
<h4><span class="header-section-number">8.6.4.2</span> Adaptive Bandwidth</h4>
<p>To reduce these problems, adaptive spatial kernels can be used. These kernels adapt in size to variations in the density of the data so that the kernels have larger bandwidths where the data are sparse and have smaller bandwidths where the data are plentiful. As above, we first need to search for the optimal bandwidth before estimating a GWR.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># find optimal kernel bandwidth using cross validation</span>
abw &lt;-<span class="st"> </span><span class="kw">gwr.sel</span>(eq1, 
               <span class="dt">data =</span> utla_shp, 
               <span class="dt">coords=</span><span class="kw">cbind</span>( lat, long),
               <span class="dt">longlat =</span> <span class="ot">TRUE</span>,
               <span class="dt">adapt =</span> <span class="ot">TRUE</span>, 
               <span class="dt">gweight =</span> gwr.Gauss, 
               <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

<span class="co"># view selected bandwidth</span>
abw</code></pre></div>
<pre><code>## [1] 0.0299492</code></pre>
<p>The optimal bandwidth is 0.03 indicating the proportion of observations (or k-nearest neighbours) to be included in the weighthing scheme. In this example, the optimal bandwidth indcates that for a given UTLA 3% of its nearest neighbours should be used to calibrate the relevant local regression; that is about 5 UTLAs. The search window will thus be variable in size depending on the extent of UTLAs. Note that here the optimal bandwidth is defined based on a data point’s k-nearest neighbours. It can also be defined by on geographical distance as done above for the fixed spatial kernel. We next fit a GWR based on an adaptive bandwidth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># fit a gwr based on adaptive bandwidth</span>
ab_gwr &lt;-<span class="st"> </span><span class="kw">gwr</span>(eq1, 
            <span class="dt">data =</span> utla_shp,
            <span class="dt">coords=</span><span class="kw">cbind</span>( lat, long),
            <span class="dt">longlat =</span> <span class="ot">TRUE</span>,
            <span class="dt">adapt =</span> abw, 
            <span class="dt">gweight =</span> gwr.Gauss,
            <span class="dt">hatmatrix=</span><span class="ot">TRUE</span>, 
            <span class="dt">se.fit=</span><span class="ot">TRUE</span>)

ab_gwr</code></pre></div>
<pre><code>## Call:
## gwr(formula = eq1, data = utla_shp, coords = cbind(lat, long), 
##     gweight = gwr.Gauss, adapt = abw, hatmatrix = TRUE, longlat = TRUE, 
##     se.fit = TRUE)
## Kernel function: gwr.Gauss 
## Adaptive quantile: 0.0299492 (about 4 of 150 data points)
## Summary of GWR coefficient estimates at data points:
##                  Min.  1st Qu.   Median  3rd Qu.     Max.  Global
## X.Intercept.  -204.03   -18.69   124.56   242.76   386.98  63.768
## ethnic        -148.41   106.29   234.78   291.24  1076.84 271.096
## lt_illness   -2088.79  -868.29  -106.46   782.93  1510.41 216.198
## Number of data points: 150 
## Effective number of parameters (residual: 2traceS - traceS&#39;S): 50.87778 
## Effective degrees of freedom (residual: 2traceS - traceS&#39;S): 99.12222 
## Sigma (residual: 2traceS - traceS&#39;S): 37.12782 
## Effective number of parameters (model: traceS): 37.82821 
## Effective degrees of freedom (model: traceS): 112.1718 
## Sigma (model: traceS): 34.90142 
## Sigma (ML): 30.18139 
## AICc (GWR p. 61, eq 2.33; p. 96, eq. 4.21): 1553.579 
## AIC (GWR p. 96, eq. 4.22): 1485.677 
## Residual sum of squares: 136637.5 
## Quasi-global R2: 0.782993</code></pre>
</div>
</div>
<div id="model-fit" class="section level3">
<h3><span class="header-section-number">8.6.5</span> Model fit</h3>
<p>Assessing the global fit of the model, marginal improvements are observed. The <span class="math inline">\(AIC\)</span> and <em>Residual sum of squares</em> experienced marginal reductions, while the <span class="math inline">\(R^{2}\)</span> increased compared to the GRW based on a fixed kernel. To gain a better understanding of these changes, as above, we map the <span class="math inline">\(R^{2}\)</span> values for the estimated local regressions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># write gwr output into a data frame</span>
ab_gwr_out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(ab_gwr<span class="op">$</span>SDF)

utla_shp<span class="op">$</span>amb_ethnic &lt;-<span class="st"> </span>ab_gwr_out<span class="op">$</span>ethnic
utla_shp<span class="op">$</span>amb_lt_illness &lt;-<span class="st"> </span>ab_gwr_out<span class="op">$</span>lt_illness
utla_shp<span class="op">$</span>amb_localR2 &lt;-<span class="st"> </span>ab_gwr_out<span class="op">$</span>localR2

<span class="co"># map</span>
  <span class="co"># Local R2</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Adaptive: Local R2&quot;</span>)
map_abgwr1 =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;amb_localR2&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_abgwr1 <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span></code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The map reveals notable improvements in local estimates for UTLAs within West and East Midlands, the South East, South West and East of England. Estimates are still poor in hot spot UTLAs concentrating confirmed cases of COVID-19, such as the Greater London, Liverpool and Newcastle areas.</p>
</div>
<div id="interpretation-1" class="section level3">
<h3><span class="header-section-number">8.6.6</span> Interpretation</h3>
<p>The key strength of GWR models is in identifying patterns of spatial variation in the associations between pairs of variables. The results reveal how these coefficients vary across the 150 UTLAs of England. To examine this variability, let’s first focus on the adaptive GWR output reported above. The output includes a summary of GWR coefficient estimates at various data points. The last column reports the global estimates which are the same as the coefficients from the OLS regression we fitted at the strat of our analysis. For our variable nonwhite ethnic population, the GWR outputs reveals that local coefficients range from a minimum value of -148.41 to a maximum value of 1076.84, indicating that one percentage point increase in the share of nonwhite ethnic population is associated with a a reduction of 148.41 in the number of cummulative confirmed cases of COVID-19 per 100,000 people in some UTLAs and an increase of 1076.84 in others. For half of the UTLAs in the dataset, as the share of nonwhite ethnic population increases by one percentage point, the rate of COVID-19 will decrease between 106.29 and 291.24 cases; that is, the inter-quartile range between the 1st Qu and the 3rd Qu. To analyse the spatial structure, we next map the estimated coefficients obtained from the adaptive kernel GWR.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="co"># Ethnic</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Ethnic&quot;</span>)
map_abgwr2 =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;amb_ethnic&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_abgwr2 =<span class="st"> </span>map_abgwr2 <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span>

  <span class="co"># Long-term Illness</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Long-term illness&quot;</span>)
map_abgwr3 =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;amb_lt_illness&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">palette =</span> <span class="kw">magma</span>(<span class="dv">256</span>), <span class="dt">style =</span> <span class="st">&quot;cont&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>) <span class="co"># change background colour</span>
map_abgwr3 =<span class="st"> </span>map_abgwr3 <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span>

<span class="kw">tmap_arrange</span>(map_abgwr2, map_abgwr3)</code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Analysing the map for long-term illness, a clear North-South divide can be identified. In the North we observed the expected positive relationship between COVID-19 and long-term illness i.e. as the share of local population suffering from long-term illness rises, the cummulative number of positive COVID-19 cases is expected to increase. In the South, we observe the inverse pattern i.e. as the share of local population suffering from long-term illness rises, the cummulative number of positive COVID-19 cases is expected to drop. This pattern is counterintuitive but may be explained by the wider socio-economic disadvantages between the North and the South of England. The North is usually characterised by a persistent concentration of more disadvantaged neighbourhoods than the South where affluent households have tended to cluster for the last 40 years <span class="citation">(Rowe, Patias, and Arribas-Bel <a href="#ref-rowe2020policy">2020</a>)</span>.</p>
</div>
<div id="assessing-statistical-significance" class="section level3">
<h3><span class="header-section-number">8.6.7</span> Assessing statistical significance</h3>
<p>While the maps above offer valuable insights to understand the spatial pattering of relationships, they do not identify whether these associations are statistically significant. They may not be. Roughly, if a coefficient estimate has an absolute value of t greater than 1.96 and the sample is sufficiently large, then it is statistically significant. Our sample has only 150 observations, so we are more conservative and considered a coefficient to be statistically significant if it has an absolute value of t larger than 2. Note also that p-values could be computed - see <span class="citation">Lu et al. (<a href="#ref-lu2014gwmodel">2014</a>)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compute t statistic</span>
utla_shp<span class="op">$</span>t_ethnic =<span class="st"> </span>ab_gwr_out<span class="op">$</span>ethnic <span class="op">/</span><span class="st"> </span>ab_gwr_out<span class="op">$</span>ethnic_se

<span class="co"># categorise t values</span>
utla_shp<span class="op">$</span>t_ethnic_cat &lt;-<span class="st"> </span><span class="kw">cut</span>(utla_shp<span class="op">$</span>t_ethnic,
                     <span class="dt">breaks=</span><span class="kw">c</span>(<span class="kw">min</span>(utla_shp<span class="op">$</span>t_ethnic), <span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="kw">max</span>(utla_shp<span class="op">$</span>t_ethnic)),
                     <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;sig&quot;</span>,<span class="st">&quot;nonsig&quot;</span>, <span class="st">&quot;sig&quot;</span>))

<span class="co"># map statistically significant coefs for ethnic</span>
legend_title =<span class="st"> </span><span class="kw">expression</span>(<span class="st">&quot;Ethnic: significant&quot;</span>)
map_sig =<span class="st"> </span><span class="kw">tm_shape</span>(utla_shp) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">tm_fill</span>(<span class="dt">col =</span> <span class="st">&quot;t_ethnic_cat&quot;</span>, <span class="dt">title =</span> legend_title, <span class="dt">legend.hist =</span> <span class="ot">TRUE</span>, <span class="dt">midpoint =</span> <span class="ot">NA</span>, <span class="dt">textNA =</span> <span class="st">&quot;&quot;</span>, <span class="dt">colorNA =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># add fill</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">1</span>)  <span class="op">+</span><span class="st"> </span><span class="co"># add borders</span>
<span class="st">  </span><span class="kw">tm_compass</span>(<span class="dt">type =</span> <span class="st">&quot;arrow&quot;</span>, <span class="dt">position =</span> <span class="kw">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;top&quot;</span>) , <span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add compass</span>
<span class="st">  </span><span class="kw">tm_scale_bar</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">text.size =</span> <span class="fl">0.7</span>, <span class="dt">position =</span>  <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;bottom&quot;</span>)) <span class="op">+</span><span class="st"> </span><span class="co"># add scale bar</span>
<span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">bg.color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">legend.outside =</span> <span class="ot">TRUE</span>) <span class="co"># change background colour &amp; place legend outside</span>

map_sig <span class="op">+</span><span class="st"> </span><span class="kw">tm_shape</span>(reg_shp) <span class="op">+</span><span class="st"> </span><span class="co"># add region boundaries</span>
<span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">lwd =</span> .<span class="dv">5</span>) <span class="co"># add borders</span></code></pre></div>
<p><img src="07-gwr_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># utla count</span>
<span class="kw">table</span>(utla_shp<span class="op">$</span>t_ethnic_cat)</code></pre></div>
<pre><code>## 
##    sig nonsig 
##    101     49</code></pre>
<p>For the share of nonwhite population, 67% of all local coefficients are statistically significant and these are largerly in the South of England. Coefficients in the North tend to be insignificant. Through outliers exist in both regions. In the South, nonsignificant coefficients are observed in the metropolitan areas of London, Birmingham and Nottingham, while significant coefficients exist in the areas of Newcastle and Middlesbrough in the North.</p>
<blockquote>
<p>Challenge 3 Compute the t values for the intercept and estimated coefficient for long-term illness and create maps of their statistical significance. How many UTLAs report statistically significant coefficients?</p>
</blockquote>
</div>
<div id="collinearity-in-gwr" class="section level3">
<h3><span class="header-section-number">8.6.8</span> Collinearity in GWR</h3>
<p>A important final note is: collinearity tends to be problematic in GWR models. It can be present in the data subsets to estimate local coefficients even when not observed globally <span class="citation">Wheeler and Tiefelsdorf (<a href="#ref-wheeler2005multicollinearity">2005</a>)</span>. Collinearity can be highly problematic in the case of compositional, categorical and ordinal predictors, and may result in exact local collinearity making the search for a optimal bandwidth impossible. A recent paper suggests potential ways foward <span class="citation">(Comber et al. <a href="#ref-comber2020gwr">2020</a>)</span>.</p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-belsley2005regression">
<p>Belsley, David A, Edwin Kuh, and Roy E Welsch. 2005. <em>Regression Diagnostics: Identifying Influential Data and Sources of Collinearity</em>. Vol. 571. John Wiley &amp; Sons.</p>
</div>
<div id="ref-brunsdon1998geographically">
<p>Brunsdon, Chris, Stewart Fotheringham, and Martin Charlton. 1998. “Geographically Weighted Regression.” <em>Journal of the Royal Statistical Society: Series D (the Statistician)</em> 47 (3). Wiley Online Library: 431–43.</p>
</div>
<div id="ref-comber2020gwr">
<p>Comber, Alexis, Chris Brunsdon, Martin Charlton, Guanpeng Dong, Rich Harris, Binbin Lu, Yihe Lü, et al. 2020. “The Gwr Route Map: A Guide to the Informed Application of Geographically Weighted Regression.” <em>arXiv Preprint arXiv:2004.06070</em>.</p>
</div>
<div id="ref-Fotheringham_et_al_2002_book">
<p>Fotheringham, Stewart, Chris Brunsdon, and Martin Charlton. 2002. <em>Geographically Weighted Regression</em>. John Wiley &amp; Sons, Ltd.</p>
</div>
<div id="ref-lu2014gwmodel">
<p>Lu, Binbin, Paul Harris, Martin Charlton, and Chris Brunsdon. 2014. “The Gwmodel R Package: Further Topics for Exploring Spatial Heterogeneity Using Geographically Weighted Models.” <em>Geo-Spatial Information Science</em> 17 (2). Taylor &amp; Francis: 85–101.</p>
</div>
<div id="ref-rowe2020policy">
<p>Rowe, Francisco, Nikos Patias, and Dani Arribas-Bel. 2020. “Policy Brief: Neighbourhood Change and Trajectories of Inequality in Britain, 1971-2011.”</p>
</div>
<div id="ref-wheeler2005multicollinearity">
<p>Wheeler, David, and Michael Tiefelsdorf. 2005. “Multicollinearity and Correlation Among Local Regression Coefficients in Geographically Weighted Regression.” <em>Journal of Geographical Systems</em> 7 (2). Springer: 161–87.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="45">
<li id="fn45"><p>This note is part of <a href="index.html">Spatial Analysis Notes</a> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Geographically Weighted Regression – Spatial Nonstationarity</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://franciscorowe.com" property="cc:attributionName" rel="cc:attributionURL">Francisco Rowe</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.<a href="geographically-weighted-regression.html#fnref45">↩</a></p></li>
<li id="fn46"><p>You can install package <code>mypackage</code> by running the command <code>install.packages(&quot;mypackage&quot;)</code> on the R prompt or through the <code>Tools --&gt; Install Packages...</code> menu in RStudio.<a href="geographically-weighted-regression.html#fnref46">↩</a></p></li>
<li id="fn47"><p>Read the file in R by executing <code>read_tsv(&quot;data/gwr/readme.txt&quot;)</code><a href="geographically-weighted-regression.html#fnref47">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multilevel-modelling-part-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="space-time-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-gwr.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["spatial_analysis_notes.pdf", "spatial_analysis_notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
